<!DOCTYPE html>
<html lang="en">
<HEAD>
    <META charset="UTF-8">

    <META name="viewport" content="width=device-width, initial-scale=1">
    <TITLE>Restore.SqlRestore C# (CSharp) Code Examples - HotExamples</TITLE>
    <META name="keywords" content="C# (CSharp),code,examples,,,,Restore,SqlRestore,0">
    <META name="description" content="C# (CSharp) Restore.SqlRestore - 30 examples found. These are the top rated real world C# (CSharp) examples of Restore.SqlRestore extracted from open source projects. You can rate examples to help us improve the quality of examples.">
    <LINK href="hellohelp_files/3229ffce42c844d7ede4dc3d49eebd1b99228893.css"
          rel="stylesheet">
    <LINK href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html"
          rel="canonical">
    <LINK href="https://csharp.hotexamples.com/ru/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html"
          rel="alternate" hreflang="ru">
    <LINK href="https://csharp.hotexamples.com/de/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html"
          rel="alternate" hreflang="de">
    <LINK href="/images/csharp/apple-touch-icon.png"
          rel="apple-touch-icon" sizes="180x180">
    <LINK href="/images/csharp/favicon-32x32.png"
          rel="icon" type="image/png" sizes="32x32">
    <LINK href="/images/csharp/favicon-16x16.png"
          rel="icon" type="image/png" sizes="16x16">
    <LINK href="/images/csharp/site.webmanifest"
          rel="manifest">
    <LINK href="/images/csharp/safari-pinned-tab.svg" rel="mask-icon"
          color="#5bbad5">
    <LINK href="/images/csharp/favicon.ico"
          rel="shortcut icon">
    <META name="msapplication-TileColor" content="#ffffff">
    <META name="msapplication-config" content="/images/csharp/browserconfig.xml">

    <META name="theme-color" content="#ffffff">
    <STYLE>
        .ezoic-ad.box-2 {
            display: block !important;
            float: none;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 60px;
            min-width: 468px;
            text-align: center !important;
        }

        .ezoic-ad.box-3 {
            display: block !important;
            float: none !important;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 250px;
            min-width: 970px;
            text-align: center !important;
        }

        .ezoic-ad.medrectangle-3 {
            display: block !important;
            float: none !important;
            margin-bottom: 2px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 2px !important;
            min-height: 420px;
            min-width: 580px;
            text-align: center !important;
        }

        .ezoic-ad.box-1 {
            display: inline-block;
            float: none;
            margin-bottom: 2px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 2px !important;
            min-height: 270px;
            min-width: 250px;
        }

        .ezoic-ad.large-billboard-2 {
            display: block !important;
            float: none;
            margin-bottom: 30px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 2px !important;
            min-height: 250px;
            min-width: 250px;
            text-align: center !important;
        }

        .ezoic-ad.large-leaderboard-1 {
            display: inline-block;
            float: none !important;
            margin-bottom: 2px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 2px !important;
            min-height: 270px;
            min-width: 250px;
        }

        .ezoic-ad.medrectangle-4 {
            display: block !important;
            float: none;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 90px;
            min-width: 728px;
            text-align: center !important;
        }

        .ezoic-ad.box-4 {
            display: block !important;
            float: none !important;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 400px;
            min-width: 580px;
            text-align: center !important;
        }

        .ezoic-ad.banner-1 {
            display: block !important;
            float: none;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 90px;
            min-width: 728px;
            text-align: center !important;
        }

        .ezoic-ad.large-leaderboard-2 {
            display: block !important;
            float: none;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 90px;
            min-width: 728px;
            text-align: center !important;
        }

        .ezoic-ad.leader-1 {
            display: block !important;
            float: none !important;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 250px;
            min-width: 300px;
            text-align: center !important;
        }

        .ezoic-ad.large-mobile-banner-2 {
            display: block !important;
            float: none;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 250px;
            min-width: 300px;
            text-align: center !important;
        }

        .ezoic-ad.leader-2 {
            display: block !important;
            float: none;
            margin-bottom: 2px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 2px !important;
            min-height: 270px;
            min-width: 300px;
            text-align: center !important;
        }

        .ezoic-ad.leader-3 {
            display: block !important;
            float: none;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 250px;
            min-width: 300px;
            text-align: center !important;
        }

        .ezoic-ad.large-mobile-banner-1 {
            display: block !important;
            float: none;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 90px;
            min-width: 728px;
            text-align: center !important;
        }

        .ezoic-ad.leader-4 {
            display: block !important;
            float: none;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 250px;
            min-width: 300px;
            text-align: center !important;
        }

        .ezoic-ad.netboard-1 {
            display: block !important;
            float: none;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 90px;
            min-width: 728px;
            text-align: center !important;
        }

        .ezoic-ad.narrow-sky-1 {
            display: block !important;
            float: none;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 250px;
            min-width: 250px;
            text-align: center !important;
        }

        .ezoic-ad.mobile-leaderboard-2 {
            display: block !important;
            float: none;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 250px;
            min-width: 250px;
            text-align: center !important;
        }

        .ezoic-ad.mobile-leaderboard-1 {
            display: block !important;
            float: none;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 250px;
            min-width: 300px;
            text-align: center !important;
        }

        .ezoic-ad.narrow-sky-2 {
            display: block !important;
            float: none;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 250px;
            min-width: 300px;
            text-align: center !important;
        }

        .ezoic-ad.portrait-1 {
            display: block !important;
            float: none;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 250px;
            min-width: 300px;
            text-align: center !important;
        }

        .ezoic-ad.netboard-2 {
            display: block !important;
            float: none;
            margin-bottom: 15px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 15px !important;
            min-height: 250px;
            min-width: 300px;
            text-align: center !important;
        }

        .ezoic-ad.banner-2 {
            display: inline-block;
            float: none;
            margin-bottom: 2px !important;
            margin-left: 0px !important;
            margin-right: 0px !important;
            margin-top: 2px !important;
            min-height: 300px;
            min-width: 336px;
        }

        .ezoic-ad {
            display: inline-block;
        }

        .adtester-container-129 {
            display: none !important;
        }

        .adtester-container-127 {
            display: none !important;
        }

        .adtester-container-121 {
            display: none !important;
        }

        .adtester-container-123 {
            display: none !important;
        }

        .adtester-container-124 {
            display: none !important;
        }

        .adtester-container-133 {
            display: none !important;
        }

        .adtester-container-118 {
            display: none !important;
        }

        .adtester-container-142 {
            display: none !important;
        }

        .adtester-container-143 {
            display: none !important;
        }

        .adtester-container-116 {
            display: none !important;
        }

        .adtester-container-117 {
            display: none !important;
        }

        .adtester-container-112 {
            display: none !important;
        }

        .adtester-container-122 {
            display: none !important;
        }

        .adtester-container-114 {
            display: none !important;
        }

        .adtester-container-138 {
            display: none !important;
        }

        .adtester-container-132 {
            display: none !important;
        }

        .adtester-container-119 {
            display: none !important;
        }

        .adtester-container-104 {
            display: none !important;
        }

        .adtester-container-113 {
            display: none !important;
        }

        .adtester-container-126 {
            display: none !important;
        }

        .adtester-container-128 {
            display: none !important;
        }

        .adtester-container-130 {
            display: none !important;
        }

        .adtester-container-125 {
            display: none !important;
        }

        .adtester-container-115 {
            display: none !important;
        }

        .adtester-container-137 {
            display: none !important;
        }

        .adtester-container-100 {
            display: none !important;
        }

        .adtester-container-120 {
            display: none !important;
        }

        .ezoic-floating-bottom {
            display: none !important;
        }
    </STYLE>





    <style type="text/css">

          		.titleyoutube  {
  			width: 100%;
  			max-width: 854px;
  			margin: 0 auto;
  		}

        .containeryoutube {
            width: 100%;
            /*max-width: 854px;*/
            min-width: 440px;
            background: #fff;
            margin: 0 auto;
        }


        /*  VIDEO PLAYER CONTAINER
        ############################### */
        .vid-container {
            position: relative;
            padding-bottom: 52%;
            padding-top: 30px;
            height: 0;
        }

            .vid-container iframe,
            .vid-container object,
            .vid-container embed {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
            }


        /*  VIDEOS PLAYLIST
        ############################### */
        .vid-list-container {
            width: 92%;
            overflow: hidden;
            margin-top: 20px;
            margin-left: 4%;
            padding-bottom: 20px;
        }

        .vid-list {
            width: 1344px;
            position: relative;
            top: 0;
            left: 0;
        }

        .vid-item {
            display: block;
            width: 148px;
            height: 148px;
            float: left;
            margin: 0;
            padding: 10px;
        }

        .thumb {
            /*position: relative;*/
            overflow: hidden;
            height: 84px;
        }

            .thumb img {
                width: 100%;
                position: relative;
                top: -13px;
            }

        .vid-item .desc {
            color: #21A1D2;
            font-size: 15px;
            margin-top: 5px;
        }

        .vid-item:hover {
            background: #eee;
            cursor: pointer;
        }

        .arrows {
            position: relative;
            width: 100%;
        }

        .arrow-left {
            color: #fff;
            position: absolute;
            background: #777;
            padding: 15px;
            left: -0px;
            top: -130px;
            z-index: 99;
            cursor: pointer;
        }

        .arrow-right {
            color: #fff;
            position: absolute;
            background: #777;
            padding: 15px;
            right: -0px;
            top: -130px;
            z-index: 100;
            cursor: pointer;
        }

        .arrow-left:hover {
            background: #CC181E;
        }

        .arrow-right:hover {
            background: #CC181E;
        }


        @media (max-width: 624px) {
            .vid-list-container {
                padding-bottom: 20px;
            }

            /* reposition left/right arrows */
            .arrows {
                position: relative;
                margin: 0 auto;
                width: 96px;
            }

            .arrow-left {
                left: 0;
                top: -17px !important;
            }

            .arrow-right {
                right: 0;
                top: -17px !important;
            }
        }
    </style>
</HEAD>
<body>
    <div class="wrap">

            <div class="containeryoutube">

                <!-- THE YOUTUBE PLAYER -->
                <div class="vid-container">
                    <iframe width="858" height="480" id="vid_frame" src="http://www.youtube.com/embed/SYhQK94s-QA?rel=0&showinfo=0&autohide=1" frameborder="0"  allowfullscreen></iframe>
                </div>
                <div class="titleyoutube"><h2>Demo: Responsive YouTube Player with Scrolling Thumbnail Playlist</h2></div>

                <div style="">
                    <!-- THE PLAYLIST -->
                    <div class="vid-list-container">
                        <div class="vid-list">

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src = 'http://youtube.com/embed/SYhQK94s-QA?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/EQaifsI1fwk/0.jpg"></div>
                                <div class="desc">Jessica Hernandez & the Deltas - Dead Brains</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src = 'http://youtube.com/embed/euLA_oLN8n8?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/euLA_oLN8n8/0.jpg"></div>
                                <div class="desc">Barbatuques - CD Tum P&aacute; - Sambalel&ecirc;</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/F1f-gn_mG8M?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/F1f-gn_mG8M/0.jpg"></div>
                                <div class="desc">Eleanor Turner plays Baroque Flamenco</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/fB8UTheTR7s?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/fB8UTheTR7s/0.jpg"></div>
                                <div class="desc">Sleepy Man Banjo Boys: Bluegrass</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/0SNhAKyXtC8?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/0SNhAKyXtC8/0.jpg"></div>
                                <div class="desc">Edmar Castaneda: NPR Music Tiny Desk Concert</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/RTHI_uGyfTM?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/RTHI_uGyfTM/0.jpg"></div>
                                <div class="desc">Winter Harp performs Caravan</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/abQRt6p8T7g?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/abQRt6p8T7g/0.jpg"></div>
                                <div class="desc">The Avett Brothers Tiny Desk Concert</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/fpmN9JorFew?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/fpmN9JorFew/0.jpg"></div>
                                <div class="desc">Tracy Chapman - Give Me One Reason</div>
                            </div>
                            <div class="vid-item" onClick="document.getElementById('vid_frame').src = 'http://youtube.com/embed/kkYnE6AkyWk?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/kkYnE6AkyWk/0.jpg"></div>
                                <div class="desc">Jessica Hernandez & the Deltas - Dead Brains</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/_Tz7KROhuAw?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/_Tz7KROhuAw/0.jpg"></div>
                                <div class="desc">Barbatuques - CD Tum P&aacute; - Sambalel&ecirc;</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/F1f-gn_mG8M?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/F1f-gn_mG8M/0.jpg"></div>
                                <div class="desc">Eleanor Turner plays Baroque Flamenco</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/fB8UTheTR7s?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/fB8UTheTR7s/0.jpg"></div>
                                <div class="desc">Sleepy Man Banjo Boys: Bluegrass</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/0SNhAKyXtC8?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/0SNhAKyXtC8/0.jpg"></div>
                                <div class="desc">Edmar Castaneda: NPR Music Tiny Desk Concert</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/RTHI_uGyfTM?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/RTHI_uGyfTM/0.jpg"></div>
                                <div class="desc">Winter Harp performs Caravan</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/abQRt6p8T7g?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/abQRt6p8T7g/0.jpg"></div>
                                <div class="desc">The Avett Brothers Tiny Desk Concert</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/fpmN9JorFew?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/fpmN9JorFew/0.jpg"></div>
                                <div class="desc">Tracy Chapman - Give Me One Reason</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/fpmN9JorFew?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/fpmN9JorFew/0.jpg"></div>
                                <div class="desc">Tracy Chapman - Give Me One Reason</div>
                            </div>
                            <div class="vid-item" onClick="document.getElementById('vid_frame').src = 'http://youtube.com/embed/kkYnE6AkyWk?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/kkYnE6AkyWk/0.jpg"></div>
                                <div class="desc">Jessica Hernandez & the Deltas - Dead Brains</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/_Tz7KROhuAw?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/_Tz7KROhuAw/0.jpg"></div>
                                <div class="desc">Barbatuques - CD Tum P&aacute; - Sambalel&ecirc;</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/F1f-gn_mG8M?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/F1f-gn_mG8M/0.jpg"></div>
                                <div class="desc">Eleanor Turner plays Baroque Flamenco</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/fB8UTheTR7s?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/fB8UTheTR7s/0.jpg"></div>
                                <div class="desc">Sleepy Man Banjo Boys: Bluegrass</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/0SNhAKyXtC8?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/0SNhAKyXtC8/0.jpg"></div>
                                <div class="desc">Edmar Castaneda: NPR Music Tiny Desk Concert</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/RTHI_uGyfTM?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/RTHI_uGyfTM/0.jpg"></div>
                                <div class="desc">Winter Harp performs Caravan</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/abQRt6p8T7g?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/abQRt6p8T7g/0.jpg"></div>
                                <div class="desc">The Avett Brothers Tiny Desk Concert</div>
                            </div>

                            <div class="vid-item" onClick="document.getElementById('vid_frame').src='http://youtube.com/embed/fpmN9JorFew?autoplay=1&rel=0&showinfo=0&autohide=1'">
                                <div class="thumb"><img src="http://img.youtube.com/vi/fpmN9JorFew/0.jpg"></div>
                                <div class="desc">Tracy Chapman - Give Me One Reason</div>
                            </div>
                        </div>
                    </div>


                </div>
                <!-- LEFT AND RIGHT ARROWS -->
                <div class="arrows">
                    <div class="arrow-left"><i class="fa fa-chevron-left fa-lg"><</i></div>
                    <div class="arrow-right"><i class="fa fa-chevron-right fa-lg">></i></div>
                </div>
            </div>
      
        <div class="container " style="display: flex;">
            <div class="page-container page-container-with-fixed-sidebar300px">
                <SPAN class="ezoic-adpicker-ad"
                      id="ezoic-pub-ad-placeholder-141"></SPAN><SPAN class="ezoic-ad box-2 adtester-container adtester-container-141"
                                                                     style="margin: 15px 0px !important; text-align: center !important; float: none; display: block !important; min-height: 60px; min-width: 468px;"
                                                                     data-ez-name="hotexamples_com-box-2">
                    <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-box-2-0"
                          style="display: inline-block; position: relative; z-index: 0; min-height: 60px; min-width: 468px;"
                          ezah="60" ezaw="468">
                    </SPAN>
                </SPAN>
                <div style="margin-bottom: 10px;">
                    <H1>C# (CSharp) Restore.SqlRestore Examples</H1><SPAN id="ezoic-pub-ad-placeholder-103"></SPAN><SPAN class="ezoic-ad box-3 adtester-container adtester-container-103" style="margin: 15px 0px !important; text-align: center !important; float: none !important; display: block !important; min-height: 250px; min-width: 970px;"
                                                                                                                         data-ez-name="hotexamples_com-box-3">
                        <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-box-3-0"
                              style="display: inline-block; position: relative; z-index: 0; min-height: 250px; min-width: 970px;"
                              ezah="250" ezaw="970">
                        </SPAN>
                    </SPAN>
                    <div class="examples-description-container">
                        <div class="hidden-xs">
                            <SPAN id="ezoic-pub-ad-placeholder-129"></SPAN>
                        </div>
                        <div class="examples-description">
                            <STRONG>
                                C# (CSharp) Restore.SqlRestore - 30
                                examples found
                            </STRONG>. These are the top rated real world C# (CSharp) examples
                            of <STRONG>Restore.SqlRestore</STRONG> extracted from open source projects. You
                            can rate examples to help us improve the quality of examples.

                            <div class="example-info-table">
                                <div><SPAN>Programming Language:</SPAN> C# (CSharp)</div>
                                <div><SPAN>Class/Type:</SPAN> <A href="https://csharp.hotexamples.com/examples/-/Restore/-/php-restore-class-examples.html">Restore</A></div>
                                <div><SPAN>Method/Function:</SPAN> SqlRestore</div>
                                <div><SPAN>Examples at hotexamples.com:</SPAN> 30</div>
                            </div>
                        </div>
                        <div class="hidden-xs">
                            <SPAN id="ezoic-pub-ad-placeholder-130"></SPAN>
                        </div>
                    </div><SPAN id="ezoic-pub-ad-placeholder-105"></SPAN><SPAN class="ezoic-ad medrectangle-3 adtester-container adtester-container-105"
                                                                               style="margin: 2px 0px !important; text-align: center !important; float: none !important; display: block !important; min-height: 420px; min-width: 580px;"
                                                                               data-ez-name="hotexamples_com-medrectangle-3">
                        <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-medrectangle-3-0"
                              style="display: inline-block; position: relative; z-index: 0; min-height: 400px; min-width: 580px;"
                              ezah="400" ezaw="580">
                        </SPAN>
                    </SPAN>
                    <div class="visible-xs visible-sm visible-md">
                        <div class="bs-example thin" style="margin-top: 15px;">
                            <div class="bs-example-title">Frequently Used Methods</div>
                            <div class="fields-controls visible-sm visible-xs visible-md">
                                <A class="btn btn-default fields-show-btn"
                                   aria-expanded="false" aria-controls="fields-panel" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#fields-panel"
                                   data-toggle="collapse">Show</A>         <A class="btn btn-default fields-hide-btn"
                                                                              aria-expanded="false" aria-controls="fields-panel" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#fields-panel"
                                                                              data-toggle="collapse">Hide</A>
                            </div>
                        </div><FIGURE class="highlight panel fields-panel collapse"
                                      id="fields-panel">
                            <div style="overflow: hidden; -ms-text-overflow: ellipsis;">
                                <A href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html">SqlRestore(30)</A>
                            </div>
                            <div style="overflow: hidden; -ms-text-overflow: ellipsis;">
                                <A href="https://csharp.hotexamples.com/examples/-/Restore/ReadFileList/php-restore-readfilelist-method-examples.html">ReadFileList(7)</A>
                            </div>
                            <div style="overflow: hidden; -ms-text-overflow: ellipsis;">
                                <A href="https://csharp.hotexamples.com/examples/-/Restore/SqlVerify/php-restore-sqlverify-method-examples.html">SqlVerify(6)</A>
                            </div>
                            <div style="overflow: hidden; -ms-text-overflow: ellipsis;">
                                <A href="https://csharp.hotexamples.com/examples/-/Restore/ReadBackupHeader/php-restore-readbackupheader-method-examples.html">ReadBackupHeader(4)</A>
                            </div>
                            <div style="overflow: hidden; -ms-text-overflow: ellipsis;">
                                <A href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestoreAsync/php-restore-sqlrestoreasync-method-examples.html">SqlRestoreAsync(3)</A>
                            </div>
                            <div style="overflow: hidden; -ms-text-overflow: ellipsis;">
                                <A href="https://csharp.hotexamples.com/examples/-/Restore/Script/php-restore-script-method-examples.html"
                                   rel="nofollow">Script(1)</A>
                            </div>
                        </FIGURE>
                    </div>
                </div>
                <div class="page-content-container">
                    <div class="sidebar hidden-xs hidden-sm hidden-md" style="width: 300px;">
                        <SPAN id="ezoic-pub-ad-placeholder-101"></SPAN><SPAN class="ezoic-ad box-1 adtester-container adtester-container-101"
                                                                             style="margin: 2px 0px !important; float: none; display: inline-block; min-height: 270px; min-width: 250px;"
                                                                             data-ez-name="hotexamples_com-box-1">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-box-1-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 250px; min-width: 250px;"
                                  ezah="250" ezaw="250">
                            </SPAN>
                        </SPAN>
                        <div class="bs-example thin">
                            <div class="bs-example-title">
                                Frequently Used Methods
                            </div>
                        </div><FIGURE class="highlight panel fields-panel " id="fields-panel">
                            <div style="overflow: hidden; -ms-text-overflow: ellipsis;">
                                <A href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html">
                                    SqlRestore
                                    (30)
                                </A>
                            </div>
                            <div style="overflow: hidden; -ms-text-overflow: ellipsis;">
                                <A href="https://csharp.hotexamples.com/examples/-/Restore/ReadFileList/php-restore-readfilelist-method-examples.html">
                                    ReadFileList
                                    (7)
                                </A>
                            </div>
                            <div style="overflow: hidden; -ms-text-overflow: ellipsis;">
                                <A href="https://csharp.hotexamples.com/examples/-/Restore/SqlVerify/php-restore-sqlverify-method-examples.html">
                                    SqlVerify
                                    (6)
                                </A>
                            </div>
                            <div style="overflow: hidden; -ms-text-overflow: ellipsis;">
                                <A href="https://csharp.hotexamples.com/examples/-/Restore/ReadBackupHeader/php-restore-readbackupheader-method-examples.html">
                                    ReadBackupHeader
                                    (4)
                                </A>
                            </div>
                            <div style="overflow: hidden; -ms-text-overflow: ellipsis;">
                                <A href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestoreAsync/php-restore-sqlrestoreasync-method-examples.html">
                                    SqlRestoreAsync
                                    (3)
                                </A>
                            </div>
                            <div style="overflow: hidden; -ms-text-overflow: ellipsis;">
                                <A href="https://csharp.hotexamples.com/examples/-/Restore/Script/php-restore-script-method-examples.html"
                                   rel="nofollow">Script                (1)</A>
                            </div>
                        </FIGURE><SPAN class="ezoic-adpicker-ad"
                                       id="ezoic-pub-ad-placeholder-140"></SPAN><SPAN class="ezoic-ad large-billboard-2 adtester-container adtester-container-140"
                                                                                      style="margin: 2px 0px 30px !important; text-align: center !important; float: none; display: block !important; min-height: 250px; min-width: 250px;"
                                                                                      data-ez-name="hotexamples_com-large-billboard-2">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-large-billboard-2-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 250px; min-width: 250px;"
                                  ezah="250" ezaw="250">
                            </SPAN>
                        </SPAN><SPAN id="ezoic-pub-ad-placeholder-102"></SPAN><SPAN class="ezoic-ad large-leaderboard-1 adtester-container adtester-container-102"
                                                                                    style="margin: 2px 0px !important; float: none !important; display: inline-block; min-height: 270px; min-width: 250px;"
                                                                                    data-ez-name="hotexamples_com-large-leaderboard-1">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-large-leaderboard-1-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 250px; min-width: 250px;"
                                  ezah="250" ezaw="250">
                            </SPAN>
                        </SPAN>
                    </div>
                    <div class="main-content">
                        <div class="addthis_inline_share_toolbox_o6yp"></div><SPAN id="ezoic-pub-ad-placeholder-106"></SPAN><SPAN class="ezoic-ad medrectangle-4 adtester-container adtester-container-106" style="margin: 15px 0px !important; text-align: center !important; float: none; display: block !important; min-height: 90px; min-width: 728px;"
                                                                                                                                  data-ez-name="hotexamples_com-medrectangle-4">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-medrectangle-4-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 90px; min-width: 728px;"
                                  ezah="90" ezaw="728">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0xa9b8376c4f86d933e1e486a21fa6a801f6423f18ac142b9ed6ddef3c282f5b02-52,,85,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #1</div>
                                    <div id="rating_1" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="52,,85," data-hash="0xa9b8376c4f86d933e1e486a21fa6a801f6423f18ac142b9ed6ddef3c282f5b02">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '1')" data-id="rating_1"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'1')" data-id="rating_1"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0xa9b8376c4f86d933e1e486a21fa6a801f6423f18ac142b9ed6ddef3c282f5b02-52,,85,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0xa9b8376c4f86d933e1e486a21fa6a801f6423f18ac142b9ed6ddef3c282f5b02&amp;fullName=RestoreDatabaseTask.cs&amp;project=andrewburgess%2FSparklesTasks')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fandrewburgess%2FSparklesTasks%2Fblob%2Fmaster%2FRestoreDatabaseTask.cs"
                                               target="_blank" rel="nofollow">RestoreDatabaseTask.cs</A>
                                        </NOBR>                                 <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fandrewburgess%2FSparklesTasks"
                                               target="_blank" rel="nofollow">andrewburgess/SparklesTasks</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="1">
<PRE class="line-numbers language-csharp" data-end="85" data-highlight="82" data-start="53">        protected override void ExecuteTask()
        {
            var server = new Server(ServerName);
            server.ConnectionContext.LoginSecure = true;
            server.ConnectionContext.Connect();
            if (!ReplaceDB)
            {
                if (server.Databases.Contains(DBName))
                {
                    Log(Level.Info, DBName + " exists on " + ServerName + " and will not be replaced");
                    return;
                }
            }
            Log(Level.Info, "Restoring database " + DBName + " to " + ServerName);
            var restore = new Restore();
            restore.Database = DBName;
            restore.ReplaceDatabase = ReplaceDB;
            restore.Action = RestoreActionType.Database;
            restore.Devices.AddDevice(BackupPath, DeviceType.File);
            var table = restore.ReadFileList(server);
            restore.RelocateFiles.Add(new RelocateFile(table.Rows[0][0].ToString(), Path.Combine(server.Settings.DefaultFile, DBName + ".mdf")));
            restore.RelocateFiles.Add(new RelocateFile(table.Rows[1][0].ToString(), Path.Combine(server.Settings.DefaultFile, DBName + "_Log.ldf")));
            restore.PercentComplete += UpdatePercent;
            restore.Complete += RestoreCompleted;
            restore.SqlRestore(server);
            if (server.ConnectionContext.IsOpen)
                server.ConnectionContext.Disconnect();
        }</PRE>
                                </div>
                            </FIGURE>
                        </div><SPAN id="ezoic-pub-ad-placeholder-107"></SPAN><SPAN class="ezoic-ad box-4 adtester-container adtester-container-107"
                                                                                   style="margin: 15px 0px !important; text-align: center !important; float: none !important; display: block !important; min-height: 400px; min-width: 580px;"
                                                                                   data-ez-name="hotexamples_com-box-4">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-box-4-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 400px; min-width: 580px;"
                                  ezah="400" ezaw="580">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0x666af0db0d574d116d3ab00da0f89e1874f3997116e590bd075a00663d2aa819-38,,66,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #2</div>
                                    <div id="rating_2" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="38,,66," data-hash="0x666af0db0d574d116d3ab00da0f89e1874f3997116e590bd075a00663d2aa819">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '2')" data-id="rating_2"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'2')" data-id="rating_2"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0x666af0db0d574d116d3ab00da0f89e1874f3997116e590bd075a00663d2aa819-38,,66,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0x666af0db0d574d116d3ab00da0f89e1874f3997116e590bd075a00663d2aa819&amp;fullName=Package_Manager%2FDbService.cs&amp;project=egormozzharov%2FpackageManager')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fegormozzharov%2FpackageManager%2Fblob%2Fmaster%2FPackage_Manager%2FDbService.cs"
                                               target="_blank" rel="nofollow">DbService.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fegormozzharov%2FpackageManager"
                                               target="_blank" rel="nofollow">egormozzharov/packageManager</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="2">
<PRE class="line-numbers language-csharp" data-end="66" data-highlight="58" data-start="39">	public void RestoreDatabase(SqlConnectionStringBuilder sqlConnection, String backUpFile)
	{
		ServerConnection serverConnection = null;
		try
		{
			if (!FileManager.FileExists(backUpFile))
			{
				throw new FileNotFoundException();
			}
			serverConnection = new ServerConnection(sqlConnection.DataSource, sqlConnection.UserID, sqlConnection.Password);
			Server sqlServer = new Server(serverConnection);
			Restore restoreDatabase = new Restore()
			{
				Action = RestoreActionType.Database,
				Database = sqlConnection.InitialCatalog,
			};
			BackupDeviceItem backupItem = new BackupDeviceItem(backUpFile, DeviceType.File);
			restoreDatabase.Devices.Add(backupItem);
			restoreDatabase.ReplaceDatabase = true;
			restoreDatabase.SqlRestore(sqlServer);
		}
		finally
		{
			if (serverConnection != null &amp;&amp; serverConnection.IsOpen)
			{
				serverConnection.Disconnect();
			}
		}
	}</PRE>
                                </div>
                            </FIGURE>
                        </div><SPAN id="ezoic-pub-ad-placeholder-108"></SPAN><SPAN class="ezoic-ad banner-1 adtester-container adtester-container-108"
                                                                                   style="margin: 15px 0px !important; text-align: center !important; float: none; display: block !important; min-height: 90px; min-width: 728px;"
                                                                                   data-ez-name="hotexamples_com-banner-1">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-banner-1-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 90px; min-width: 728px;"
                                  ezah="90" ezaw="728">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0x7e455aa4fa5f2391b0da1b96e9b223f1bf7fdcba442c14e336c894faa9d3b818-36,,61,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #3</div>
                                    <div id="rating_3" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="36,,61," data-hash="0x7e455aa4fa5f2391b0da1b96e9b223f1bf7fdcba442c14e336c894faa9d3b818">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '3')" data-id="rating_3"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'3')" data-id="rating_3"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0x7e455aa4fa5f2391b0da1b96e9b223f1bf7fdcba442c14e336c894faa9d3b818-36,,61,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0x7e455aa4fa5f2391b0da1b96e9b223f1bf7fdcba442c14e336c894faa9d3b818&amp;fullName=VisLabForms%2FClasses%2FImplementation%2FSQLAdmin.cs&amp;project=A-n-d-r-e-y%2FVISLAB')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2FA-n-d-r-e-y%2FVISLAB%2Fblob%2Fmaster%2FVisLabForms%2FClasses%2FImplementation%2FSQLAdmin.cs"
                                               target="_blank" rel="nofollow">SQLAdmin.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2FA-n-d-r-e-y%2FVISLAB"
                                               target="_blank" rel="nofollow">A-n-d-r-e-y/VISLAB</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="3">
<PRE class="line-numbers language-csharp" data-end="61" data-highlight="61" data-start="37">        public static void MakeRestore(ServerMessageEventHandler onComplete, Guid id,
            string serverName, string dbName, string uncDir, string userName, string password)
        {
            var sc = new ServerConnection(serverName);
            sc.LoginSecure = false;
            sc.Login = userName;
            sc.Password = password;
            var srv = new Server(sc);
            var rest = new Restore();
            rest.Action = RestoreActionType.Database;
            rest.Database = dbName;
            rest.Devices.AddDevice(Path.Combine(uncDir, rest.Database + ".bak"), DeviceType.File);
            rest.ReplaceDatabase = true;
            var headers = rest.ReadBackupHeader(srv);
            var query = from DataRow row in headers.Rows
                        where (string)row["BackupName"] == id.ToString()
                        select (Int16)row["Position"];
            rest.FileNumber = query.First();
            if (onComplete != null) rest.Complete += onComplete;
            rest.SqlRestore(srv);
        }</PRE>
                                </div>
                            </FIGURE>
                        </div><SPAN id="ezoic-pub-ad-placeholder-109"></SPAN><SPAN class="ezoic-ad large-leaderboard-2 adtester-container adtester-container-109"
                                                                                   style="margin: 15px 0px !important; text-align: center !important; float: none; display: block !important; min-height: 90px; min-width: 728px;"
                                                                                   data-ez-name="hotexamples_com-large-leaderboard-2">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-large-leaderboard-2-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 90px; min-width: 728px;"
                                  ezah="90" ezaw="728">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0x637cf0c945c0508e1f921c478d948a5b2c818c10a6c13667c78679af2dc9e055-41,,53,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #4</div>
                                    <div id="rating_4" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="41,,53," data-hash="0x637cf0c945c0508e1f921c478d948a5b2c818c10a6c13667c78679af2dc9e055">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '4')" data-id="rating_4"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'4')" data-id="rating_4"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0x637cf0c945c0508e1f921c478d948a5b2c818c10a6c13667c78679af2dc9e055-41,,53,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0x637cf0c945c0508e1f921c478d948a5b2c818c10a6c13667c78679af2dc9e055&amp;fullName=Test%2FNakedObjects.DatabaseHelpers%2FDatabaseUtils.cs&amp;project=Robin--%2FNakedObjectsFramework')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2FRobin--%2FNakedObjectsFramework%2Fblob%2Fmaster%2FTest%2FNakedObjects.DatabaseHelpers%2FDatabaseUtils.cs"
                                               target="_blank" rel="nofollow">DatabaseUtils.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2FRobin--%2FNakedObjectsFramework"
                                               target="_blank" rel="nofollow">Robin--/NakedObjectsFramework</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="4">
<PRE class="line-numbers language-csharp" data-end="53" data-highlight="53" data-start="42">        public static void RestoreDatabase(string databaseName, string backupName, string serverName = Server) {
            Server server = string.IsNullOrEmpty(serverName) ? new Server() : new Server(serverName);
            var restore = new Restore {
                Database = databaseName,
                Action = RestoreActionType.Database,
                ReplaceDatabase = true,
                NoRecovery = false
            };
            restore.Devices.AddDevice(backupName + ".bak", DeviceType.File);
            server.KillAllProcesses(databaseName);
            restore.SqlRestore(server);
        }</PRE>
                                </div>
                            </FIGURE>
                        </div><SPAN id="ezoic-pub-ad-placeholder-110"></SPAN><SPAN class="ezoic-ad leader-1 adtester-container adtester-container-110"
                                                                                   style="margin: 15px 0px !important; text-align: center !important; float: none !important; display: block !important; min-height: 250px; min-width: 300px;"
                                                                                   data-ez-name="hotexamples_com-leader-1">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-leader-1-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 250px; min-width: 300px;"
                                  ezah="250" ezaw="300">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0x973af8750ac4ff87a74be853d61c15e06772b4d7636e33964b4bc1dc0a3ed747-13,,59,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #5</div>
                                    <div id="rating_5" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="13,,59," data-hash="0x973af8750ac4ff87a74be853d61c15e06772b4d7636e33964b4bc1dc0a3ed747">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '5')" data-id="rating_5"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'5')" data-id="rating_5"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0x973af8750ac4ff87a74be853d61c15e06772b4d7636e33964b4bc1dc0a3ed747-13,,59,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0x973af8750ac4ff87a74be853d61c15e06772b4d7636e33964b4bc1dc0a3ed747&amp;fullName=Program.cs&amp;project=anishihara%2FExtremely-simple-mssql-restore-console-app')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fanishihara%2FExtremely-simple-mssql-restore-console-app%2Fblob%2Fmaster%2FProgram.cs"
                                               target="_blank" rel="nofollow">Program.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fanishihara%2FExtremely-simple-mssql-restore-console-app"
                                               target="_blank"
                                               rel="nofollow">anishihara/Extremely-simple-mssql-restore-console-app</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="5">
<PRE class="line-numbers language-csharp" data-end="59" data-highlight="54" data-start="14">        static void Main(string[] args)
        {
            if (args.Length != 3)
                return;
            string serverName = args[0];
            string databaseName = args[1];
            string restoreFilePath = args[2];
            Restore restoreDB = new Restore();
            restoreDB.Database = databaseName;
            restoreDB.Action = RestoreActionType.Database;
            restoreDB.Devices.AddDevice(@restoreFilePath, DeviceType.File);
            restoreDB.ReplaceDatabase = true;
            /* If you have a differential or log restore after the current restore,
             * you would need to specify NoRecovery = true, this will ensure no
             * recovery performed and subsequent restores are allowed. It means it
             * the database will be in a restoring state. */
            restoreDB.NoRecovery = false;
            restoreDB.PercentComplete += (obj, e) =&gt; { Console.WriteLine("Percent completed: {0}%.", e.Percent); };
            Server srv = new Server(@serverName);
            /* Check if database exists, if not, create one. */
            Database db = srv.Databases[databaseName];
            if (db == null)
            {
                db = new Database(srv,databaseName);
                Console.WriteLine("Creating database...");
                db.Create();
                Console.WriteLine("Created {0}.", databaseName);
            }
            Console.WriteLine("Verifying backup media...");
            bool valid = restoreDB.SqlVerify(srv);
            if (valid)
            {
                Console.WriteLine("Backup media is valid.");
                Console.WriteLine("Starting restore...");
                restoreDB.SqlRestore(srv);
            }
            else
            {
                Console.WriteLine("Backup media is invalid. Aborting operation...");
            }
        }</PRE>
                                </div>
                            </FIGURE>
                        </div><SPAN class="ezoic-adpicker-ad" id="ezoic-pub-ad-placeholder-133"></SPAN>
                        <SPAN id="ezoic-pub-ad-placeholder-111"></SPAN><SPAN class="ezoic-ad large-mobile-banner-2 adtester-container adtester-container-111"
                                                                             style="margin: 15px 0px !important; text-align: center !important; float: none; display: block !important; min-height: 250px; min-width: 300px;"
                                                                             data-ez-name="hotexamples_com-large-mobile-banner-2">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-large-mobile-banner-2-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 250px; min-width: 300px;"
                                  ezah="250" ezaw="300">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0x2039b520ecdc2e2b9822eda216422723c0e38f9574ad6b773904407a0bd214f0-38,,57,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #6</div>
                                    <div id="rating_6" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="38,,57," data-hash="0x2039b520ecdc2e2b9822eda216422723c0e38f9574ad6b773904407a0bd214f0">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '6')" data-id="rating_6"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'6')" data-id="rating_6"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0x2039b520ecdc2e2b9822eda216422723c0e38f9574ad6b773904407a0bd214f0-38,,57,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0x2039b520ecdc2e2b9822eda216422723c0e38f9574ad6b773904407a0bd214f0&amp;fullName=TimeSeriesAnalysis%2FRestoreDBHelper.cs&amp;project=LiloS%2FTimeSeriesAnalysis')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2FLiloS%2FTimeSeriesAnalysis%2Fblob%2Fmaster%2FTimeSeriesAnalysis%2FRestoreDBHelper.cs"
                                               target="_blank" rel="nofollow">RestoreDBHelper.cs</A>
                                        </NOBR>                                 <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2FLiloS%2FTimeSeriesAnalysis"
                                               target="_blank" rel="nofollow">LiloS/TimeSeriesAnalysis</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="6">
<PRE class="line-numbers language-csharp" data-end="57" data-highlight="56" data-start="39">        /// &lt;summary&gt;
        /// Restore DB from backup.
        /// &lt;/summary&gt;
        private static bool RestoreDB()
        {
            string connectionString =
            ConfigurationManager.ConnectionStrings["DeathsConnectionString"].ToString();
              var builder = new SqlConnectionStringBuilder(connectionString);
              var myServer = new Server(builder.DataSource);
              var res = new Restore();
              res.Database = "Deaths";
              res.Action = RestoreActionType.Database;
              res.Devices.AddDevice(
            Environment.CurrentDirectory + @"\Resources\DeathsFullBackup", DeviceType.File);
              res.ReplaceDatabase = true;
              res.SqlRestore(myServer);
              return true;
        }</PRE>
                                </div>
                            </FIGURE>
                        </div><SPAN class="ezoic-adpicker-ad" id="ezoic-pub-ad-placeholder-144"></SPAN><SPAN class="ezoic-ad leader-2 adtester-container adtester-container-144"
                                                                                                             style="margin: 2px 0px !important; text-align: center !important; float: none; display: block !important; min-height: 270px; min-width: 300px;"
                                                                                                             data-ez-name="hotexamples_com-leader-2">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-leader-2-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 250px; min-width: 300px;"
                                  ezah="250" ezaw="300">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0x497b5a625b31ebbddeae5c3d7ef434d5b2c1421317b38146cdeee67e68c6d89c-25,,69,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #7</div>
                                    <div id="rating_7" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="25,,69," data-hash="0x497b5a625b31ebbddeae5c3d7ef434d5b2c1421317b38146cdeee67e68c6d89c">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '7')" data-id="rating_7"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'7')" data-id="rating_7"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0x497b5a625b31ebbddeae5c3d7ef434d5b2c1421317b38146cdeee67e68c6d89c-25,,69,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0x497b5a625b31ebbddeae5c3d7ef434d5b2c1421317b38146cdeee67e68c6d89c&amp;fullName=DbTool%2FDbTool.Lib.SqlServer%2FRestoreTask.cs&amp;project=pedershk%2Fdotnetprograms')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fpedershk%2Fdotnetprograms%2Fblob%2Fmaster%2FDbTool%2FDbTool.Lib.SqlServer%2FRestoreTask.cs"
                                               target="_blank" rel="nofollow">RestoreTask.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fpedershk%2Fdotnetprograms"
                                               target="_blank" rel="nofollow">pedershk/dotnetprograms</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="7">
<PRE class="line-numbers language-csharp" data-end="69" data-highlight="57" data-start="26">        public void Restore(BackupParameters parameters)
        {
            var databaseName = parameters.DatabaseName;
            var filePath = GetFullPathFrom(parameters.FilePath);
            Logger.WriteLine("Restoring {0} from file {1}", databaseName, filePath);
            var server = new Server(parameters.Server);
            try
            {
                server.ConnectionContext.LoginSecure = true;
                server.ConnectionContext.Connect();
                var restore = new Restore { Database = databaseName, Action = RestoreActionType.Database };
                restore.Devices.AddDevice(filePath, DeviceType.File);
                restore.ReplaceDatabase = true;
                var database = server.Databases[databaseName];
                if (database == null)
                {
                    Logger.WriteLine("Database {0} does not exist", databaseName);
                    return;
                }
                var users = server.GetLoginUsers(database);
                Logger.WriteLine("User mappings to restore: {0}", string.Join(",", users));
                RelocateFiles(database, restore);
                server.RenewConnection();
                restore.PercentComplete += HandlePercentComplete;
                restore.Complete += HandleComplete;
                restore.SqlRestore(server);
                RestoreUserMappings(server, users, databaseName);
            }
            finally
            {
                if (server.ConnectionContext.IsOpen)
                {
                    Logger.Write("Closing connection...");
                    server.ConnectionContext.Disconnect();
                    Logger.WriteLine("OK");
                }
            }
        }</PRE>
                                </div>
                            </FIGURE>
                        </div><SPAN class="ezoic-adpicker-ad" id="ezoic-pub-ad-placeholder-145"></SPAN><SPAN class="ezoic-ad leader-3 adtester-container adtester-container-145"
                                                                                                             style="margin: 15px 0px !important; text-align: center !important; float: none; display: block !important; min-height: 250px; min-width: 300px;"
                                                                                                             data-ez-name="hotexamples_com-leader-3">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-leader-3-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 250px; min-width: 300px;"
                                  ezah="250" ezaw="300">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0x9650f1e1cedc024fb1d5c9977eb83aa5c2388e8832291fba30dc2a7fe4582bac-15,,54,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #8</div>
                                    <div id="rating_8" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="15,,54," data-hash="0x9650f1e1cedc024fb1d5c9977eb83aa5c2388e8832291fba30dc2a7fe4582bac">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '8')" data-id="rating_8"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'8')" data-id="rating_8"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0x9650f1e1cedc024fb1d5c9977eb83aa5c2388e8832291fba30dc2a7fe4582bac-15,,54,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0x9650f1e1cedc024fb1d5c9977eb83aa5c2388e8832291fba30dc2a7fe4582bac&amp;fullName=ketoansoft.vstore.app%2FClass%2FRestoreHelper.cs&amp;project=thanhphung901%2Fketoan.app')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fthanhphung901%2Fketoan.app%2Fblob%2Fmaster%2Fketoansoft.vstore.app%2FClass%2FRestoreHelper.cs"
                                               target="_blank" rel="nofollow">RestoreHelper.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fthanhphung901%2Fketoan.app"
                                               target="_blank" rel="nofollow">thanhphung901/ketoan.app</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="8">
<PRE class="line-numbers language-csharp" data-end="54" data-highlight="43" data-start="16">        public void RestoreDatabase(String databaseName, String filePath, String serverName, String userName, String password, String dataFilePath, String logFilePath)
        {
            try
            {
                Restore sqlRestore = new Restore();
                BackupDeviceItem deviceItem = new BackupDeviceItem(filePath, DeviceType.File);
                sqlRestore.Devices.Add(deviceItem);
                sqlRestore.Database = databaseName;
                ServerConnection connection = new ServerConnection(serverName, userName, password);
                Server sqlServer = new Server(connection);
                Database db = sqlServer.Databases[databaseName];
                sqlRestore.Action = RestoreActionType.Database;
                String dataFileLocation = dataFilePath + databaseName + ".mdf";
                String logFileLocation = logFilePath + databaseName + "_Log.ldf";
                db = sqlServer.Databases[databaseName];
                RelocateFile rf = new RelocateFile(databaseName, dataFileLocation);
                sqlRestore.RelocateFiles.Add(new RelocateFile(databaseName, dataFileLocation));
                sqlRestore.RelocateFiles.Add(new RelocateFile(databaseName + "_log", logFileLocation));
                sqlRestore.ReplaceDatabase = true;
                sqlRestore.Complete += new ServerMessageEventHandler(sqlRestore_Complete);
                sqlRestore.PercentCompleteNotification = 10;
                sqlRestore.PercentComplete += new PercentCompleteEventHandler(sqlRestore_PercentComplete);
                sqlRestore.SqlRestore(sqlServer);
                db = sqlServer.Databases[databaseName];
                db.SetOnline();
                sqlServer.Refresh();
            }
            catch (SqlServerManagementException ex)
            {
                ex.Message.ToString();
            }
        }</PRE>
                                </div>
                            </FIGURE>
                        </div><SPAN class="ezoic-adpicker-ad" id="ezoic-pub-ad-placeholder-134"></SPAN><SPAN class="ezoic-ad large-mobile-banner-1 adtester-container adtester-container-134"
                                                                                                             style="margin: 15px 0px !important; text-align: center !important; float: none; display: block !important; min-height: 90px; min-width: 728px;"
                                                                                                             data-ez-name="hotexamples_com-large-mobile-banner-1">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-large-mobile-banner-1-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 90px; min-width: 728px;"
                                  ezah="90" ezaw="728">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0xcef9667a15c8d56bd9daa1d20714c15c47aaeaadf83a70456907a96d52a71639-38,,61,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #9</div>
                                    <div id="rating_9" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="38,,61," data-hash="0xcef9667a15c8d56bd9daa1d20714c15c47aaeaadf83a70456907a96d52a71639">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '9')" data-id="rating_9"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'9')" data-id="rating_9"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0xcef9667a15c8d56bd9daa1d20714c15c47aaeaadf83a70456907a96d52a71639-38,,61,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0xcef9667a15c8d56bd9daa1d20714c15c47aaeaadf83a70456907a96d52a71639&amp;fullName=Source%2FServerExtensions.cs&amp;project=hveiras%2FTeamMashup')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fhveiras%2FTeamMashup%2Fblob%2Fmaster%2FSource%2FServerExtensions.cs"
                                               target="_blank" rel="nofollow">ServerExtensions.cs</A>
                                        </NOBR>                                 <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fhveiras%2FTeamMashup"
                                               target="_blank" rel="nofollow">hveiras/TeamMashup</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="9">
<PRE class="line-numbers language-csharp" data-end="61" data-highlight="61" data-start="39">        public static void RestoreDatabase(this Server server, string databaseName, string filePath)
        {
            var res = new Restore();
            res.Devices.AddDevice(filePath, DeviceType.File);
            var DataFile = new RelocateFile();
            string MDF = res.ReadFileList(server).Rows[0][1].ToString();
            DataFile.LogicalFileName = res.ReadFileList(server).Rows[0][0].ToString();
            DataFile.PhysicalFileName = server.Databases[databaseName].FileGroups[0].Files[0].FileName;
            var LogFile = new RelocateFile();
            string LDF = res.ReadFileList(server).Rows[1][1].ToString();
            LogFile.LogicalFileName = res.ReadFileList(server).Rows[1][0].ToString();
            LogFile.PhysicalFileName = server.Databases[databaseName].LogFiles[0].FileName;
            res.RelocateFiles.Add(DataFile);
            res.RelocateFiles.Add(LogFile);
            res.Database = databaseName;
            res.NoRecovery = false;
            res.ReplaceDatabase = true;
            res.SqlRestore(server);
        }</PRE>
                                </div>
                            </FIGURE>
                        </div>
                        <div class="example-item" id="0xcb98b9d3d9463a0ebeffe5606308edaa34f347bbc026baa37cf1480a4ba75130-124,,180,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #10</div>
                                    <div id="rating_10" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="124,,180," data-hash="0xcb98b9d3d9463a0ebeffe5606308edaa34f347bbc026baa37cf1480a4ba75130">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '10')" data-id="rating_10"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'10')" data-id="rating_10"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0xcb98b9d3d9463a0ebeffe5606308edaa34f347bbc026baa37cf1480a4ba75130-124,,180,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0xcb98b9d3d9463a0ebeffe5606308edaa34f347bbc026baa37cf1480a4ba75130&amp;fullName=DBBackup.cs&amp;project=cleciobarbosa%2Fstudy')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fcleciobarbosa%2Fstudy%2Fblob%2Fmaster%2FDBBackup.cs"
                                               target="_blank" rel="nofollow">DBBackup.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fcleciobarbosa%2Fstudy"
                                               target="_blank" rel="nofollow">cleciobarbosa/study</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="10">
<PRE class="line-numbers language-csharp" data-end="180" data-highlight="159" data-start="125">        private void btn_restore_Click(object sender, EventArgs e)
        {
            if (cmbDataBase.SelectedIndex.ToString().Equals(""))
            {
                MessageBox.Show("Please choose Database", "Server", MessageBoxButtons.OK, MessageBoxIcon.Information);
                return;
            }
            // If there was a SQL connection created
            if (_srvr != null)
            {
                try
                {
                    btn_backup.Enabled = false;
                    btn_restore.Enabled = false;
                    db_change.Enabled = false;
                    server_change.Enabled = false;
                    Cursor = Cursors.WaitCursor;
                    // If the user has chosen the file from which he wants the database to be restored
                    // Create a new database restore operation
                    var rstDatabase = new Restore
                    {
                        Action = RestoreActionType.Database,
                        Database = cmbDataBase.SelectedItem.ToString()
                    };
                    // Set the restore type to a database restore
                    // Set the database that we want to perform the restore on
                    // Set the backup device from which we want to restore, to a file
                    var bkpDevice = new BackupDeviceItem(_dBpath + "\\Backup.bak", DeviceType.File);
                    // Add the backup device to the restore type
                    rstDatabase.Devices.Add(bkpDevice);
                    // If the database already exists, replace it
                    rstDatabase.ReplaceDatabase = true;
                    // Perform the restore
                    rstDatabase.SqlRestore(_srvr);
                    MessageBox.Show("Database " + cmbDataBase.Text + " succefully restored", "Server", MessageBoxButtons.OK, MessageBoxIcon.Information);
                }
                catch (Exception)
                {
                    MessageBox.Show("ERROR: An error ocurred while restoring the database", "Application Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
                }
                finally
                {
                    Cursor = Cursors.Arrow;
                    btn_backup.Enabled = true;
                    btn_restore.Enabled = true;
                    db_change.Enabled = true;
                    server_change.Enabled = true;
                }
            }
            else
            {
                MessageBox.Show("ERROR: A connection to a SQL server was not established.", "Server", MessageBoxButtons.OK, MessageBoxIcon.Error);
                Cursor = Cursors.Arrow;
            }
        }</PRE>
                                </div>
                            </FIGURE>
                        </div><SPAN class="ezoic-adpicker-ad" id="ezoic-pub-ad-placeholder-146"></SPAN><SPAN class="ezoic-ad leader-4 adtester-container adtester-container-146"
                                                                                                             style="margin: 15px 0px !important; text-align: center !important; float: none; display: block !important; min-height: 250px; min-width: 300px;"
                                                                                                             data-ez-name="hotexamples_com-leader-4">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-leader-4-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 250px; min-width: 300px;"
                                  ezah="250" ezaw="300">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0xa1dc34d541a287640dfaff2727757fd4c0e7b9f86037a3560d2f6a0824dd2f4c-259,,270,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #11</div>
                                    <div id="rating_11" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="259,,270," data-hash="0xa1dc34d541a287640dfaff2727757fd4c0e7b9f86037a3560d2f6a0824dd2f4c">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '11')" data-id="rating_11"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'11')" data-id="rating_11"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0xa1dc34d541a287640dfaff2727757fd4c0e7b9f86037a3560d2f6a0824dd2f4c-259,,270,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0xa1dc34d541a287640dfaff2727757fd4c0e7b9f86037a3560d2f6a0824dd2f4c&amp;fullName=Desktop%2FRecordKeeper%2FRecordKeeper%2FconnRecordkeeperData.cs&amp;project=rskulkarni%2FSoftwareE')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Frskulkarni%2FSoftwareE%2Fblob%2Fmaster%2FDesktop%2FRecordKeeper%2FRecordKeeper%2FconnRecordkeeperData.cs"
                                               target="_blank" rel="nofollow">connRecordkeeperData.cs</A>
                                        </NOBR>                                 <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Frskulkarni%2FSoftwareE"
                                               target="_blank" rel="nofollow">rskulkarni/SoftwareE</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="11">
<PRE class="line-numbers language-csharp" data-end="270" data-highlight="270" data-start="260"> public void RestoreDatabase(string backUpFile)
 {
     ServerConnection serverConnection = new ServerConnection(@"ROHAN-PC\SQLEXPRESS");
     Server myServer = new Server(serverConnection);
     Restore destination = new Restore();
     destination.Action = RestoreActionType.Database;
     destination.Database = "RecordKeeper";
     BackupDeviceItem source = new BackupDeviceItem(backUpFile, DeviceType.File);
     destination.Devices.Add(source);
     destination.ReplaceDatabase = true;
     destination.SqlRestore(myServer);
 }</PRE>
                                </div>
                            </FIGURE>
                        </div><SPAN class="ezoic-adpicker-ad" id="ezoic-pub-ad-placeholder-139"></SPAN><SPAN class="ezoic-ad netboard-1 adtester-container adtester-container-139"
                                                                                                             style="margin: 15px 0px !important; text-align: center !important; float: none; display: block !important; min-height: 90px; min-width: 728px;"
                                                                                                             data-ez-name="hotexamples_com-netboard-1">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-netboard-1-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 90px; min-width: 728px;"
                                  ezah="90" ezaw="728">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0xc269b094801fb5604769279cdf88863c9b0b5712a4b4efdebc6b5f023c61d3c1-398,,429,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #12</div>
                                    <div id="rating_12" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="398,,429," data-hash="0xc269b094801fb5604769279cdf88863c9b0b5712a4b4efdebc6b5f023c61d3c1">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '12')" data-id="rating_12"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'12')" data-id="rating_12"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0xc269b094801fb5604769279cdf88863c9b0b5712a4b4efdebc6b5f023c61d3c1-398,,429,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0xc269b094801fb5604769279cdf88863c9b0b5712a4b4efdebc6b5f023c61d3c1&amp;fullName=SageFrame%2FModules%2Fupgrade.aspx.cs&amp;project=RexSystemsbd%2FSageFrameV2.1Source')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2FRexSystemsbd%2FSageFrameV2.1Source%2Fblob%2Fmaster%2FSageFrame%2FModules%2Fupgrade.aspx.cs"
                                               target="_blank" rel="nofollow">upgrade.aspx.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2FRexSystemsbd%2FSageFrameV2.1Source"
                                               target="_blank" rel="nofollow">RexSystemsbd/SageFrameV2.1Source</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="12">
<PRE class="line-numbers language-csharp" data-end="429" data-highlight="422" data-start="399">    public static void RollBackDatabase(string databaseName, string bakfilePath)
    {
        SqlConnection.ClearAllPools();
        SqlConnection cnn = SetSingleUser(databaseName);
        ServerConnection serverConn = new ServerConnection(cnn);
        Server server = new Server(serverConn);
        Database db = server.Databases[cnn.Database];
        Restore restore = new Restore();
        restore.Action = RestoreActionType.Database;
        restore.Devices.AddDevice(bakfilePath, DeviceType.File);
        restore.Database = databaseName;
        restore.ReplaceDatabase = true;
        restore.Complete += new ServerMessageEventHandler(Restore_Completed);
        restore.PercentComplete += new PercentCompleteEventHandler(CompletionStatusInPercent);
        restore.PercentCompleteNotification = 10;
        SqlCommand cmd = cnn.CreateCommand();
        cmd.CommandText = string.Format("use master");
        cmd.ExecuteNonQuery();
        restore.SqlRestore(server);
        db = server.Databases[databaseName];
        db.SetOnline();
        server.Refresh();
        if (server.ConnectionContext.IsOpen)
            server.ConnectionContext.Disconnect();
    }</PRE>
                                </div>
                            </FIGURE>
                        </div>
                        <div class="example-item" id="0xc8193db3bd0a154ff62d293455c88dac55b700cb06ff327f2f77b4a21df10b0a-173,,189,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #13</div>
                                    <div id="rating_13" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="173,,189," data-hash="0xc8193db3bd0a154ff62d293455c88dac55b700cb06ff327f2f77b4a21df10b0a">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '13')" data-id="rating_13"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'13')" data-id="rating_13"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0xc8193db3bd0a154ff62d293455c88dac55b700cb06ff327f2f77b4a21df10b0a-173,,189,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0xc8193db3bd0a154ff62d293455c88dac55b700cb06ff327f2f77b4a21df10b0a&amp;fullName=DatabaseManager.cs&amp;project=vadimart92%2FTeamCityTools')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fvadimart92%2FTeamCityTools%2Fblob%2Fmaster%2FDatabaseManager.cs"
                                               target="_blank" rel="nofollow">DatabaseManager.cs</A>
                                        </NOBR>                                 <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fvadimart92%2FTeamCityTools"
                                               target="_blank" rel="nofollow">vadimart92/TeamCityTools</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="13">
<PRE class="line-numbers language-csharp" data-end="189" data-highlight="189" data-start="174"> private static void Restore(string backupFileName, string destinationDbName, SqlConnection connection)
 {
     Contract.Ensures(File.Exists(backupFileName), "File.Exists(backupFileName)");
     var restoreDb = new Restore
     {
         Database = destinationDbName,
         Action = RestoreActionType.Database,
         ReplaceDatabase = true,
         NoRecovery = false
     };
     restoreDb.Devices.AddDevice(backupFileName, DeviceType.File);
     connection.Open();
     var server = new Server(new ServerConnection(connection));
     var relocateFiles = GetRelocateFiles(connection, backupFileName, destinationDbName, server.DefaultFile, server.DefaultLog);
     restoreDb.RelocateFiles.AddRange(relocateFiles);
     restoreDb.SqlRestore(server);
 }</PRE>
                                </div>
                            </FIGURE>
                        </div><SPAN class="ezoic-adpicker-ad" id="ezoic-pub-ad-placeholder-135"></SPAN><SPAN class="ezoic-ad narrow-sky-1 adtester-container adtester-container-135"
                                                                                                             style="margin: 15px 0px !important; text-align: center !important; float: none; display: block !important; min-height: 250px; min-width: 250px;"
                                                                                                             data-ez-name="hotexamples_com-narrow-sky-1">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-narrow-sky-1-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 250px; min-width: 250px;"
                                  ezah="250" ezaw="250">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0x6f7555fab532809547787f483c31c4542791e59d8ecd1c99318bf6f2ade8482c-97,,212,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #14</div>
                                    <div id="rating_14" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="97,,212," data-hash="0x6f7555fab532809547787f483c31c4542791e59d8ecd1c99318bf6f2ade8482c">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '14')" data-id="rating_14"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'14')" data-id="rating_14"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0x6f7555fab532809547787f483c31c4542791e59d8ecd1c99318bf6f2ade8482c-97,,212,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0x6f7555fab532809547787f483c31c4542791e59d8ecd1c99318bf6f2ade8482c&amp;fullName=Site+Controller%2FSqlrestore.xaml.cs&amp;project=sreenandini%2Ftest_buildscripts')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fsreenandini%2Ftest_buildscripts%2Fblob%2Fmaster%2FSite+Controller%2FSqlrestore.xaml.cs"
                                               target="_blank" rel="nofollow">Sqlrestore.xaml.cs</A>
                                        </NOBR>                                 <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fsreenandini%2Ftest_buildscripts"
                                               target="_blank" rel="nofollow">sreenandini/test_buildscripts</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="14">
<PRE class="line-numbers language-csharp" data-end="212" data-highlight="170" data-start="98">        private void btnRestore_Click(object sender, RoutedEventArgs e)
        {
            string blankDBFile              =   string.Empty;
            string dbScriptsDefaultPath     =   string.Empty;
            string backupFileName           =   string.Empty;
            string sSQLServerDetails        =   string.Empty;
            bool bDBExists                  =   false;
            try
            {
                Cursor = System.Windows.Input.Cursors.Wait;
                sSQLServerDetails = GetConnectionString();
                bDBExists = DBSettings.CheckDBExists(sSQLServerDetails, txtDataBases.Text, 60);
                if (bDBExists == true)
                {
                    MessageBox.ShowText(string.Format("{0} {1}", txtDataBases.Text, FindResource("MessageID50")), BMC_Icon.Information);
                    LogManager.WriteLog(string.Format("{0} {1}", txtDataBases.Text, FindResource("MessageID50")), LogManager.enumLogLevel.Info);
                }
                else
                {
                    dbScriptsDefaultPath = ConfigurationManager.AppSettings.Get("DBScriptsDefaultPath");
                    if (this.strType.ToUpper() == "EXCHANGE")
                    {
                        blankDBFile = ConfigurationManager.AppSettings.Get("ExchangeBlankDB");
                    }
                    if (this.strType.ToUpper() == "TICKETING")
                    {
                        blankDBFile = ConfigurationManager.AppSettings.Get("TicketingBlankDB");
                    }
                    if (this.strType.ToUpper() == "EXTSYSMSG")
                    {
                        blankDBFile = ConfigurationManager.AppSettings.Get("EXTSYSMSGBlankDB");
                    }
                    backupFileName = string.Format("{0}\\{1}", dbScriptsDefaultPath, blankDBFile);
                    // Create a new connection to the Server
                    ServerConnection serverConnection = new ServerConnection(cmbServers.SelectedItem.ToString());
                    // Log in using SQL authentication instead of Windows authentication
                    serverConnection.LoginSecure = false;
                    // Give the login username
                    serverConnection.Login = txtUsername.Text;
                    // Give the login password
                    serverConnection.Password = txtPassword.Password;
                    // Create a new SQL Server object using the connection we created
                    Server server = new Server(serverConnection);
                    // Create a new database restore operation
                    Restore rstDatabase = new Restore();
                    // Set the restore type to a database restore
                    rstDatabase.Action = RestoreActionType.Database;
                    // Set the database that we want to perform the restore on
                    rstDatabase.Database = txtDataBases.Text;
                    // Set the backup device from which we want to restore the db
                    BackupDeviceItem bkpDevice = new BackupDeviceItem(backupFileName, DeviceType.File);
                    // Add the backup device to the restore type
                    rstDatabase.Devices.Add(bkpDevice);
                    // Optional. ReplaceDatabase property ensures that any existing copy of the database is overwritten.
                    rstDatabase.ReplaceDatabase = true;
                    // Perform the restore
                    rstDatabase.SqlRestore(server);
                    LogManager.WriteLog(string.Format("{0} - {1}", "Database Restore Complete. Running Updgrade Scripts for database", txtDataBases.Text), LogManager.enumLogLevel.Info);
                    if (this.strType.ToUpper() == "EXCHANGE" | this.strType.ToUpper() == "TICKETING")
                    {
                        if (Convert.ToBoolean(ConfigurationManager.AppSettings.Get("AutoRunUpgradeScriptAfterDBRestore")))
                        {
                            try
                            {
                                RunDatabaseUpgradeScripts();
                            }
                            catch (Exception ex)
                            {
                                ExceptionManager.Publish(ex);
                                if (this.strType.ToUpper() == "EXCHANGE")
                                {
                                    MessageBox.ShowBox("MessageID106", BMC_Icon.Error);
                                }
                                if (this.strType.ToUpper() == "TICKETING")
                                {
                                    MessageBox.ShowBox("MessageID107", BMC_Icon.Error);
                                }
                            }
                        }
                        LogManager.WriteLog(string.Format("{0} - {1}", "Updgrade Scripts run successfully for database", txtDataBases.Text), LogManager.enumLogLevel.Info);
                    }
                    MessageBox.ShowText(string.Format("{0} {1} {2}.", FindResource("MessageID53"), txtDataBases.Text, FindResource("MessageID54")), BMC_Icon.Information);
                }
            }            
            catch (Exception ex)
            {
                MessageBox.ShowBox("MessageID74", BMC_Icon.Error);
                ExceptionManager.Publish(ex);                
            }
            finally
            {
                btnRestore.IsEnabled = true;
                Cursor = System.Windows.Input.Cursors.Arrow;
            }
        }</PRE>
                                </div>
                            </FIGURE>
                        </div>
                        <div class="example-item" id="0xb7751d4389627dff0c856519725a94ba44d5ad12035dae6325e9338fbc63e366-49,,138,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #15</div>
                                    <div id="rating_15" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="49,,138," data-hash="0xb7751d4389627dff0c856519725a94ba44d5ad12035dae6325e9338fbc63e366">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '15')" data-id="rating_15"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'15')" data-id="rating_15"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0xb7751d4389627dff0c856519725a94ba44d5ad12035dae6325e9338fbc63e366-49,,138,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0xb7751d4389627dff0c856519725a94ba44d5ad12035dae6325e9338fbc63e366&amp;fullName=Form1.cs&amp;project=JohnFecko%2FSQLRestore')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2FJohnFecko%2FSQLRestore%2Fblob%2Fmaster%2FForm1.cs"
                                               target="_blank" rel="nofollow">Form1.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2FJohnFecko%2FSQLRestore"
                                               target="_blank" rel="nofollow">JohnFecko/SQLRestore</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="15">
<PRE class="line-numbers language-csharp" data-end="138" data-highlight="127" data-start="50">        private void btnRestore_Click(object sender, EventArgs e)
        {
            try
            {
                if (String.IsNullOrEmpty(txtPath.Text))
                {
                    MessageBox.Show("No File Selected");
                    return;
                }
                else if (!File.Exists(txtPath.Text))
                {
                    MessageBox.Show("File Not Found");
                    return;
                }
                if (String.IsNullOrEmpty(txtDatabaseName.Text))
                {
                    MessageBox.Show("No Database Name Entered");
                    return;
                }
                string path = txtPath.Text;
                string name = txtDatabaseName.Text;
                Restore sqlRestore = new Restore { Database = name };
                Server sqlServer = GetServer();
                if (sqlServer.Databases[name] != null)
                {
                    if (
                        MessageBox.Show("Delete existing database?", "Confirm Delete", MessageBoxButtons.YesNo,
                                        MessageBoxIcon.Warning) == DialogResult.Yes)
                    {
                        sqlServer.KillDatabase(name);
                    }
                    else
                    {
                        return;
                    }
                }
                Database db = new Database(sqlServer, name);
                db.Create();
                BackupDeviceItem backupDevice = new BackupDeviceItem(path, DeviceType.File);
                sqlRestore.Action = RestoreActionType.Database;
                sqlRestore.Devices.Add(backupDevice);
                var table = sqlRestore.ReadBackupHeader(sqlServer);
                var fileNumber = sqlRestore.FileNumber;
                foreach (DataRow r in table.Rows)
                {
                    var tempNum = -1;
                    if (!int.TryParse(r["Position"].ToString(), out tempNum)) continue;
                    if (tempNum &gt; fileNumber)
                    {
                        fileNumber = tempNum;
                    }
                }
                sqlRestore.FileNumber = fileNumber;
                String dataFileLocation = db.FileGroups[0].Files[0].FileName;
                String logFileLocation = db.LogFiles[0].FileName;
                db = sqlServer.Databases[name];
                sqlServer.ConnectionContext.Disconnect();
                RelocateFile rf = new RelocateFile(sqlRestore.ReadFileList(sqlServer).Rows[0]["LogicalName"].ToString(), dataFileLocation);
                RelocateFile lf = new RelocateFile(sqlRestore.ReadFileList(sqlServer).Rows[1]["LogicalName"].ToString(), logFileLocation);
                sqlRestore.RelocateFiles.Add(rf);
                sqlRestore.RelocateFiles.Add(lf);
                sqlRestore.ReplaceDatabase = true;
                sqlRestore.PercentCompleteNotification = 1;
                sqlRestore.PercentComplete += new PercentCompleteEventHandler(PercentCompleteHandler);
                //sqlRestore.Complete += new ServerMessageEventHandler(sqlRestore_Complete);
                sqlRestore.SqlRestore(sqlServer);
                db = sqlServer.Databases[name];
                db.SetOnline();
                sqlServer.Refresh();
                MessageBox.Show("Restore Completed");
                progressBar.Visible = false;
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
        }</PRE>
                                </div>
                            </FIGURE>
                        </div><SPAN class="ezoic-adpicker-ad" id="ezoic-pub-ad-placeholder-147"></SPAN><SPAN class="ezoic-ad mobile-leaderboard-2 adtester-container adtester-container-147"
                                                                                                             style="margin: 15px 0px !important; text-align: center !important; float: none; display: block !important; min-height: 250px; min-width: 250px;"
                                                                                                             data-ez-name="hotexamples_com-mobile-leaderboard-2">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-mobile-leaderboard-2-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 250px; min-width: 250px;"
                                  ezah="250" ezaw="250">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0x86e86645073dd3e0e2e47cd281ef3fc5a7fa6f577e265c830b7cae53ac3e1ec5-179,,214,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #16</div>
                                    <div id="rating_16" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="179,,214," data-hash="0x86e86645073dd3e0e2e47cd281ef3fc5a7fa6f577e265c830b7cae53ac3e1ec5">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '16')" data-id="rating_16"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'16')" data-id="rating_16"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0x86e86645073dd3e0e2e47cd281ef3fc5a7fa6f577e265c830b7cae53ac3e1ec5-179,,214,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0x86e86645073dd3e0e2e47cd281ef3fc5a7fa6f577e265c830b7cae53ac3e1ec5&amp;fullName=Codes%2FQuanLyDoanhSo%2FQuanLyDoanhSo%2FMain%2FTool%2FUcDB.cs&amp;project=vuchannguyen%2Flg-py')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fvuchannguyen%2Flg-py%2Fblob%2Fmaster%2FCodes%2FQuanLyDoanhSo%2FQuanLyDoanhSo%2FMain%2FTool%2FUcDB.cs"
                                               target="_blank" rel="nofollow">UcDB.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fvuchannguyen%2Flg-py"
                                               target="_blank" rel="nofollow">vuchannguyen/lg-py</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="16">
<PRE class="line-numbers language-csharp" data-end="214" data-highlight="202" data-start="180">        private void RestoreDB(string databaseName, string serverName, string path)
        {
            try
            {
                // Create a new database restore operation
                Restore rstDatabase = new Restore();
                // Set the restore type to a database restore
                rstDatabase.Action = RestoreActionType.Database;
                // Set the database that we want to perform the restore on
                rstDatabase.Database = databaseName;
                // Set the backup device from which we want to restore, to a file
                BackupDeviceItem deviceItem = new BackupDeviceItem(path, DeviceType.File);
                // Add the backup device to the restore type
                rstDatabase.Devices.Add(deviceItem);
                // If the database already exists, replace it
                rstDatabase.ReplaceDatabase = true;
                ServerConnection connection = new ServerConnection(serverName);
                Server sqlServer = new Server(connection);
                // Perform the restore
                rstDatabase.SqlRestore(sqlServer);
                MessageBox.Show(Constant.MESSAGE_SUCCESS_RESTORE,
                    Constant.CAPTION_CONFIRMATION, MessageBoxButtons.OK, MessageBoxIcon.Information);
                FormMain.isRestored = true;
                Application.Exit();
            }
            catch (Exception ex)
            {
                MessageBox.Show(Constant.MESSAGE_ERROR_RESTORE + Constant.MESSAGE_NEW_LINE + Constant.MESSAGE_ERROR_BACKUP_PATH,
                    Constant.CAPTION_ERROR, MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
        }</PRE>
                                </div>
                            </FIGURE>
                        </div>
                        <div class="example-item" id="0xa97eb59573ad668f67ec3b414d28526cdf8e0f9c4c42a0a8f9ea120fde93a927-153,,223,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #17</div>
                                    <div id="rating_17" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="153,,223," data-hash="0xa97eb59573ad668f67ec3b414d28526cdf8e0f9c4c42a0a8f9ea120fde93a927">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '17')" data-id="rating_17"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'17')" data-id="rating_17"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0xa97eb59573ad668f67ec3b414d28526cdf8e0f9c4c42a0a8f9ea120fde93a927-153,,223,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0xa97eb59573ad668f67ec3b414d28526cdf8e0f9c4c42a0a8f9ea120fde93a927&amp;fullName=Phan_Mem_Quan_Ly_Cam_Do%2FxfmPhucHoi.cs&amp;project=gojila%2FQuan_Ly_Cam_Do')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fgojila%2FQuan_Ly_Cam_Do%2Fblob%2Fmaster%2FPhan_Mem_Quan_Ly_Cam_Do%2FxfmPhucHoi.cs"
                                               target="_blank" rel="nofollow">xfmPhucHoi.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fgojila%2FQuan_Ly_Cam_Do"
                                               target="_blank" rel="nofollow">gojila/Quan_Ly_Cam_Do</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="17">
<PRE class="line-numbers language-csharp" data-end="223" data-highlight="215" data-start="154">        private void PhucHoiDuLieu()
        {
            GetDatabaseInformation();
            var cnn = new SqlConnection(_connectionString);
            cnn.Open();
            var conn = new ServerConnection(cnn);
            var server = new Server(conn);
            cnn.Close();
            Restore restore = new Restore();
            //string fileName = string.Format("{0}\\{1}.bak", testFolder, databaseName);
            string fileName = txtTenTapTin.Text;
            restore.Devices.Add(new BackupDeviceItem(fileName, DeviceType.File));
            // Just give it a new name
            //string destinationDatabaseName = string.Format("{0}_newly_restored", databaseName);
            string destinationDatabaseName = txtCoSoDuLieu.Text;
            // Go grab the current database’s logical names for the data
            // and log files. For this example, we assume there are 1 for each.
            //Database currentDatabase = server.Databases[databaseName];
            //string currentLogicalData_ = currentDatabase.FileGroups[0].Files[0].Name;
            //string currentLogicalLog_ = currentDatabase.LogFiles[0].Name;
            // Now relocate the data and log files
            //RelocateFile reloData = new RelocateFile(currentLogicalData, string.Format(@"{0}\{1}.mdf", testFolder, destinationDatabaseName));
            //RelocateFile reloLog = new RelocateFile(currentLogicalLog, string.Format(@"{0}\{1}_Log.ldf", testFolder, destinationDatabaseName));
            RelocateFile reloData = new RelocateFile(currentLogicalData, physicalFileName);
            RelocateFile reloLog = new RelocateFile(currentLogicalLog, physicalFileLogName);
            //MessageBox.Show(fileName);
            //MessageBox.Show(destinationDatabaseName);
            //MessageBox.Show(currentLogicalData);
            //MessageBox.Show(currentLogicalLog);
            //MessageBox.Show(currentLogicalData_);
            //MessageBox.Show(currentLogicalLog_);
            //MessageBox.Show(string.Format(@"{0}\{1}.mdf", testFolder, destinationDatabaseName));
            //MessageBox.Show(string.Format(@"{0}\{1}_Log.ldf", testFolder, destinationDatabaseName));
            //MessageBox.Show(physicalFileName);
            //MessageBox.Show(physicalFileLogName);
            restore.RelocateFiles.Add(reloData);
            restore.RelocateFiles.Add(reloLog);
            restore.Database = destinationDatabaseName;
            restore.ReplaceDatabase = true;
            restore.PercentCompleteNotification = 10;
            restore.PercentComplete += restore_PercentComplete;
            //restore.Complete += restore_Complete;
            restore.ReplaceDatabase = true;
            server.KillAllProcesses(txtCoSoDuLieu.Text);
            restore.SqlRestore(server);
            server.Refresh();
            MessageBox.Show("Quá trình hoàn tất");
            Bar.EditValue = 0;
            Bar.Refresh();
            //progressBar1.Value = 0;
            //progressBar1.Refresh();
        }</PRE>
                                </div>
                            </FIGURE>
                        </div><SPAN class="ezoic-adpicker-ad" id="ezoic-pub-ad-placeholder-148"></SPAN><SPAN class="ezoic-ad mobile-leaderboard-1 adtester-container adtester-container-148"
                                                                                                             style="margin: 15px 0px !important; text-align: center !important; float: none; display: block !important; min-height: 250px; min-width: 300px;"
                                                                                                             data-ez-name="hotexamples_com-mobile-leaderboard-1">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-mobile-leaderboard-1-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 250px; min-width: 300px;"
                                  ezah="250" ezaw="300">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0xe7c8cd2676a198ae5c29deb1084616d1e244afcbc5b26656573015d1145aae27-98,,159,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #18</div>
                                    <div id="rating_18" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="98,,159," data-hash="0xe7c8cd2676a198ae5c29deb1084616d1e244afcbc5b26656573015d1145aae27">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '18')" data-id="rating_18"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'18')" data-id="rating_18"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0xe7c8cd2676a198ae5c29deb1084616d1e244afcbc5b26656573015d1145aae27-98,,159,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0xe7c8cd2676a198ae5c29deb1084616d1e244afcbc5b26656573015d1145aae27&amp;fullName=LoanManagement%2FwpfBackUp.xaml.cs&amp;project=stisf-g1%2FLoanManagement')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fstisf-g1%2FLoanManagement%2Fblob%2Fmaster%2FLoanManagement%2FwpfBackUp.xaml.cs"
                                               target="_blank" rel="nofollow">wpfBackUp.xaml.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fstisf-g1%2FLoanManagement"
                                               target="_blank" rel="nofollow">stisf-g1/LoanManagement</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="18">
<PRE class="line-numbers language-csharp" data-end="159" data-highlight="142" data-start="99">        private void Button_Click_2(object sender, RoutedEventArgs e)
        {
            Restore rest = new Restore();
            string PathtobackUp ="";
            OpenFileDialog dlg = new OpenFileDialog();
            dlg.InitialDirectory = "c:\\";
            dlg.Filter = "Backup Files (*.bak)|*.bak|All Files (*.*)|*.*";
            dlg.RestoreDirectory = true;
            if (dlg.ShowDialog() == System.Windows.Forms.DialogResult.OK)
            {
                PathtobackUp = dlg.FileName.ToString();
            }
            else
            {
                return;
            }
            string fileName = PathtobackUp;
            //this.Cursor = Cursors.WaitCursor;
            //this.dataGridView1.DataSource = string.Empty;
            try
            {
                rest.Devices.AddDevice(fileName, DeviceType.File);
                Server srv = new Server("(localdb)\\v11.0");
                bool verifySuccessful = rest.SqlVerify(srv);
                string databaseName = "LoanManagement.Domain.finalContext";
                if (verifySuccessful)
                {
                    System.Windows.MessageBox.Show("Backup Verified!", "Info");
                    System.Windows.MessageBoxResult dr = System.Windows.MessageBox.Show("Do you want to restore?","Question",MessageBoxButton.YesNo);
                    if (dr == MessageBoxResult.Yes)
                    {
                        //fileName = dlg.FileName.Replace(Directory.GetCurrentDirectory(), "");
                        System.Windows.MessageBox.Show(fileName);
                        rest.Database = databaseName;
                        rest.Action = RestoreActionType.Database;
                        BackupDeviceItem bdi = default(BackupDeviceItem);
                        bdi = new BackupDeviceItem(fileName, DeviceType.File);
                        rest.Devices.Add(bdi);
                        //rest.Devices.Add(bdi);
                        rest.ReplaceDatabase = true;
                        srv = new Server("(localdb)\\v11.0");
                        rest.SqlRestore(srv);
                        srv.Refresh();
                        System.Windows.MessageBox.Show("Restore of " + databaseName +" Complete!");
                    }
                }
                else
                {
                    System.Windows.MessageBox.Show("ERROR: Backup not verified!", "Error");
                }
            }
            catch (Exception ex)
            {
                System.Windows.MessageBox.Show("The system has been successfully restored");
            }
            finally
            {
                //this.Cursor = Cursors.Default;
            }
        }</PRE>
                                </div>
                            </FIGURE>
                        </div>
                        <div class="example-item" id="0xcf18fa98a67eb561791e90b2d9c32e624a4f6f17f94bda595656e0e3cd23d4c1-161,,203,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #19</div>
                                    <div id="rating_19" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="161,,203," data-hash="0xcf18fa98a67eb561791e90b2d9c32e624a4f6f17f94bda595656e0e3cd23d4c1">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '19')" data-id="rating_19"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'19')" data-id="rating_19"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0xcf18fa98a67eb561791e90b2d9c32e624a4f6f17f94bda595656e0e3cd23d4c1-161,,203,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0xcf18fa98a67eb561791e90b2d9c32e624a4f6f17f94bda595656e0e3cd23d4c1&amp;fullName=BackupService.cs&amp;project=dave07747%2FTowerSearch')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fdave07747%2FTowerSearch%2Fblob%2Fmaster%2FBackupService.cs"
                                               target="_blank" rel="nofollow">BackupService.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fdave07747%2FTowerSearch"
                                               target="_blank" rel="nofollow">dave07747/TowerSearch</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="19">
<PRE class="line-numbers language-csharp" data-end="203" data-highlight="195" data-start="162">     public static void RestoreDB(string backUpFilePath, string databaseName)
     {
         try
         {
             Console.WriteLine("Restore operation started");
             Restore restore = new Restore();
             //Set type of backup to be performed to database
             restore.Database = databaseName;
             restore.Action = RestoreActionType.Database;
             //Set up the backup device to use filesystem.         
             restore.Devices.AddDevice(backUpFilePath, DeviceType.File);
             //set ReplaceDatabase = true to create new database
             //regardless of the existence of specified database
             restore.ReplaceDatabase = true;
             //If you have a differential or log restore to be followed,
             //you would specify NoRecovery = true
             restore.NoRecovery = false;
             //if you want to restore to a different location, specify
             //the logical and physical file names
             restore.RelocateFiles.Add(new RelocateFile("Test",
 @"C:\Temp\Test.mdf"));
             restore.RelocateFiles.Add(new RelocateFile("Test_Log",
 @"C:\Temp\Test_Log.ldf"));
             ServerConnection connection = new
 ServerConnection(@"SERVER_NAME");
             //my SQL user doesnt have sufficient permissions,
             //so i am using my windows account
             connection.LoginSecure = true;
             //connection.LoginSecure = false;
             //connection.Login = "testuser";
             //connection.Password = "testuser";
             Server sqlServer = new Server(connection);
             //SqlRestore method starts to restore database           
             restore.SqlRestore(sqlServer);
             Console.WriteLine("Restore operation succeeded");
         }
         catch (Exception ex)
         {
             Console.WriteLine("Restore operation failed");
             Console.WriteLine(ex.Message);
         }
         Console.ReadLine();
     }</PRE>
                                </div>
                            </FIGURE>
                        </div>
                        <div class="example-item" id="0xd8aebc2ed0fe51fe93b9935c670867c1d70079223104d10076b55dfa9584993d-231,,286,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #20</div>
                                    <div id="rating_20" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="231,,286," data-hash="0xd8aebc2ed0fe51fe93b9935c670867c1d70079223104d10076b55dfa9584993d">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '20')" data-id="rating_20"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'20')" data-id="rating_20"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0xd8aebc2ed0fe51fe93b9935c670867c1d70079223104d10076b55dfa9584993d-231,,286,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0xd8aebc2ed0fe51fe93b9935c670867c1d70079223104d10076b55dfa9584993d&amp;fullName=BDDAO.cs&amp;project=nicopisapio%2FSGE')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fnicopisapio%2FSGE%2Fblob%2Fmaster%2FBDDAO.cs"
                                               target="_blank" rel="nofollow">BDDAO.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fnicopisapio%2FSGE"
                                               target="_blank" rel="nofollow">nicopisapio/SGE</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="20">
<PRE class="line-numbers language-csharp" data-end="286" data-highlight="264" data-start="232">        public bool RealizarRestoreBD(string rutaArchivo)
        {
            bool resultado = false;
            try
            {
                string baseDeDatos = ConfigurationManager.AppSettings["BaseDeDatos"].ToString();
                if (File.Exists(rutaArchivo))
                {
                    using (SqlConnection conexion = Conexion.ObtenerInstancia().CrearConexionSQLMaster())
                    {
                        ServerConnection conexionServer = new ServerConnection(conexion);
                        Server servidor = new Server(conexionServer);
                        Restore restoreBD = new Restore();
                        restoreBD.Action = RestoreActionType.Database;
                        restoreBD.Database = baseDeDatos;
                        String query = "ALTER DATABASE " + baseDeDatos + " SET SINGLE_USER WITH ROLLBACK IMMEDIATE";
                        using(SqlCommand comando = new SqlCommand(query, conexion))
                        {
                            comando.Connection.Open();
                            comando.ExecuteNonQuery();
                        }
                        BackupDeviceItem deviceItem = new BackupDeviceItem(rutaArchivo, DeviceType.File);
                        restoreBD.Devices.Add(deviceItem);
                        restoreBD.ReplaceDatabase = true;
                        restoreBD.SqlRestore(servidor);
                        conexionServer.Disconnect();
                    }
                    resultado = true;
                }
                return resultado;
            }
            catch (AccesoBDException ex)
            {
                throw new DALException("BDDAO", "RealizarRestoreBD", "AccesoBD", ex.Message, ex);
            }
            catch (SqlException ex)
            {
                throw new DALException("BDDAO", "RealizarRestoreBD", "SQL", ex.Message, ex);
            }
            catch (Exception ex)
            {
                throw new DALException("BDDAO", "RealizarRestoreBD", "General: " + ex.GetType().ToString(), ex.Message, ex);
            }
        }</PRE>
                                </div>
                            </FIGURE>
                        </div>
                        <div class="example-item" id="0x86e86645073dd3e0e2e47cd281ef3fc5a7fa6f577e265c830b7cae53ac3e1ec5-216,,254,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #21</div>
                                    <div id="rating_21" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="216,,254," data-hash="0x86e86645073dd3e0e2e47cd281ef3fc5a7fa6f577e265c830b7cae53ac3e1ec5">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '21')" data-id="rating_21"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'21')" data-id="rating_21"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0x86e86645073dd3e0e2e47cd281ef3fc5a7fa6f577e265c830b7cae53ac3e1ec5-216,,254,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0x86e86645073dd3e0e2e47cd281ef3fc5a7fa6f577e265c830b7cae53ac3e1ec5&amp;fullName=Codes%2FQuanLyDoanhSo%2FQuanLyDoanhSo%2FMain%2FTool%2FUcDB.cs&amp;project=vuchannguyen%2Flg-py')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fvuchannguyen%2Flg-py%2Fblob%2Fmaster%2FCodes%2FQuanLyDoanhSo%2FQuanLyDoanhSo%2FMain%2FTool%2FUcDB.cs"
                                               target="_blank" rel="nofollow">UcDB.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fvuchannguyen%2Flg-py"
                                               target="_blank" rel="nofollow">vuchannguyen/lg-py</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="21">
<PRE class="line-numbers language-csharp" data-end="254" data-highlight="251" data-start="217">        private void RS()
        {
            Restore sqlRestore = new Restore();
            BackupDeviceItem deviceItem = new BackupDeviceItem(@"D:\Bakup\Weedon.bak", DeviceType.File);
            sqlRestore.Devices.Add(deviceItem);
            sqlRestore.Database = "Weedon";
            ServerConnection connection = new ServerConnection(@".\SQLEXPRESS");
            Server sqlServer = new Server(connection);
            Database db = sqlServer.Databases["Weedon"];
            sqlRestore.Action = RestoreActionType.Database;
            String dataFileLocation = @"C:\Program Files\Microsoft SQL Server\MSSQL10.SQLEXPRESS\MSSQL\DATA\Weedon.mdf";
            String logFileLocation = @"C:\Program Files\Microsoft SQL Server\MSSQL10.SQLEXPRESS\MSSQL\DATA\Weedon_Log.ldf";
            db = sqlServer.Databases["Weedon"];
            RelocateFile rf = new RelocateFile("Weedon", dataFileLocation);
            //sqlRestore.RelocateFiles.Add(new RelocateFile("Weedon", dataFileLocation));
            //sqlRestore.RelocateFiles.Add(new RelocateFile("Weedon" + "_log", logFileLocation));
            System.Data.DataTable logicalRestoreFiles = sqlRestore.ReadFileList(sqlServer);
            sqlRestore.RelocateFiles.Add(new RelocateFile(logicalRestoreFiles.Rows[0][0].ToString(), dataFileLocation));
            sqlRestore.RelocateFiles.Add(new RelocateFile(logicalRestoreFiles.Rows[1][0].ToString(), logFileLocation));
            sqlRestore.ReplaceDatabase = true;
            //sqlRestore.Complete += new ServerMessageEventHandler(sqlRestore_Complete);
            sqlRestore.PercentCompleteNotification = 10;
            //sqlRestore.PercentComplete +=
               //new PercentCompleteEventHandler(sqlRestore_PercentComplete);
            //sqlServer.ConnectionContext.Disconnect();
            sqlRestore.SqlRestore(sqlServer);
            db = sqlServer.Databases["Weedon"];
            db.SetOnline();
            sqlServer.Refresh();
        }</PRE>
                                </div>
                            </FIGURE>
                        </div><SPAN class="ezoic-adpicker-ad" id="ezoic-pub-ad-placeholder-149"></SPAN><SPAN class="ezoic-ad narrow-sky-2 adtester-container adtester-container-149" style="margin: 15px 0px !important; text-align: center !important; float: none; display: block !important; min-height: 250px; min-width: 300px;"
                                                                                                             data-ez-name="hotexamples_com-narrow-sky-2">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-narrow-sky-2-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 250px; min-width: 300px;"
                                  ezah="250" ezaw="300">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0x8f8e5795b56a56366b95f8e3ecd2b4108d5b8b4d02175191ba57d72685fe8e54-134,,147,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #22</div>
                                    <div id="rating_22" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="134,,147," data-hash="0x8f8e5795b56a56366b95f8e3ecd2b4108d5b8b4d02175191ba57d72685fe8e54">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '22')" data-id="rating_22"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'22')" data-id="rating_22"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0x8f8e5795b56a56366b95f8e3ecd2b4108d5b8b4d02175191ba57d72685fe8e54-134,,147,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0x8f8e5795b56a56366b95f8e3ecd2b4108d5b8b4d02175191ba57d72685fe8e54&amp;fullName=WitMorph%2FPrepareTestEnvironment.cs&amp;project=halvsvenskeren%2FWitMorph')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fhalvsvenskeren%2FWitMorph%2Fblob%2Fmaster%2FWitMorph%2FPrepareTestEnvironment.cs"
                                               target="_blank" rel="nofollow">PrepareTestEnvironment.cs</A>
                                        </NOBR>                                 <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fhalvsvenskeren%2FWitMorph"
                                               target="_blank" rel="nofollow">halvsvenskeren/WitMorph</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="22">
<PRE class="line-numbers language-csharp" data-end="147" data-highlight="147" data-start="135">        private static void RestoreDatabase(CollectionInformation collectionInfo, string databaseBackupFile)
        {
            var connectionStringBuilder = new SqlConnectionStringBuilder(collectionInfo.ConnectionString);
            var serverConnection = new ServerConnection(connectionStringBuilder.DataSource);
            var server = new Server(serverConnection);
            var restore = new Restore();
            restore.Devices.AddDevice(databaseBackupFile, DeviceType.File);
            restore.Database = connectionStringBuilder.InitialCatalog;
            restore.ReplaceDatabase = true;
            server.KillAllProcesses(restore.Database);
            restore.SqlRestore(server);
        }</PRE>
                                </div>
                            </FIGURE>
                        </div>
                        <div class="example-item" id="0x88d3b78b9dd4fad72a7c0382b05d88880eacd76012fe5c39479ca3ef04e8fcb4-15,,142,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #23</div>
                                    <div id="rating_23" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="15,,142," data-hash="0x88d3b78b9dd4fad72a7c0382b05d88880eacd76012fe5c39479ca3ef04e8fcb4">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '23')" data-id="rating_23"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'23')" data-id="rating_23"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0x88d3b78b9dd4fad72a7c0382b05d88880eacd76012fe5c39479ca3ef04e8fcb4-15,,142,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0x88d3b78b9dd4fad72a7c0382b05d88880eacd76012fe5c39479ca3ef04e8fcb4&amp;fullName=SourceCode%2FDatabaseOperation.cs&amp;project=iMutex%2FEBusiness')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2FiMutex%2FEBusiness%2Fblob%2Fmaster%2FSourceCode%2FDatabaseOperation.cs"
                                               target="_blank" rel="nofollow">DatabaseOperation.cs</A>
                                        </NOBR>                                 <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2FiMutex%2FEBusiness"
                                               target="_blank" rel="nofollow">iMutex/EBusiness</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="23">
<PRE class="line-numbers language-csharp" data-end="142" data-highlight="106,124" data-start="16">        void MSDNCode()
        {
            //Connect to the local, default instance of SQL Server.
            Server srv = new Server();
            //Reference the AdventureWorks2008R2 database.
            Database db = default(Database);
            db = srv.Databases["AdventureWorks2008R2"];
            //Store the current recovery model in a variable.
            int recoverymod;
            recoverymod = (int)db.DatabaseOptions.RecoveryModel;
            //Define a Backup object variable.
            Backup bk = new Backup();
            //Specify the type of backup, the description, the name, and the database to be backed up.
            bk.Action = BackupActionType.Database;
            bk.BackupSetDescription = "Full backup of Adventureworks2008R2";
            bk.BackupSetName = "AdventureWorks2008R2 Backup";
            bk.Database = "AdventureWorks2008R2";
            //Declare a BackupDeviceItem by supplying the backup device file name in the constructor, and the type of device is a file.
            BackupDeviceItem bdi = default(BackupDeviceItem);
            bdi = new BackupDeviceItem("Test_Full_Backup1", DeviceType.File);
            //Add the device to the Backup object.
            bk.Devices.Add(bdi);
            //Set the Incremental property to False to specify that this is a full database backup.
            bk.Incremental = false;
            //Set the expiration date.
            System.DateTime backupdate = new System.DateTime();
            backupdate = new System.DateTime(2006, 10, 5);
            bk.ExpirationDate = backupdate;
            //Specify that the log must be truncated after the backup is complete.
            bk.LogTruncation = BackupTruncateLogType.Truncate;
            //Run SqlBackup to perform the full database backup on the instance of SQL Server.
            bk.SqlBackup(srv);
            //Inform the user that the backup has been completed.
            Console.WriteLine("Full Backup complete.");
            //Remove the backup device from the Backup object.
            bk.Devices.Remove(bdi);
            //Make a change to the database, in this case, add a table called test_table.
            Table t = default(Table);
            t = new Table(db, "test_table");
            Column c = default(Column);
            c = new Column(t, "col", DataType.Int);
            t.Columns.Add(c);
            t.Create();
            //Create another file device for the differential backup and add the Backup object.
            BackupDeviceItem bdid = default(BackupDeviceItem);
            bdid = new BackupDeviceItem("Test_Differential_Backup1", DeviceType.File);
            //Add the device to the Backup object.
            bk.Devices.Add(bdid);
            //Set the Incremental property to True for a differential backup.
            bk.Incremental = true;
            //Run SqlBackup to perform the incremental database backup on the instance of SQL Server.
            bk.SqlBackup(srv);
            //Inform the user that the differential backup is complete.
            Console.WriteLine("Differential Backup complete.");
            //Remove the device from the Backup object.
            bk.Devices.Remove(bdid);
            //Delete the AdventureWorks2008R2 database before restoring it
               // db.Drop();
            //Define a Restore object variable.
            Restore rs = new Restore();
            //Set the NoRecovery property to true, so the transactions are not recovered.
            rs.NoRecovery = true;
            //Add the device that contains the full database backup to the Restore object.
            rs.Devices.Add(bdi);
            //Specify the database name.
            rs.Database = "AdventureWorks2008R2";
            //Restore the full database backup with no recovery.
            rs.SqlRestore(srv);
            //Inform the user that the Full Database Restore is complete.
            Console.WriteLine("Full Database Restore complete.");
            //reacquire a reference to the database
            db = srv.Databases["AdventureWorks2008R2"];
            //Remove the device from the Restore object.
            rs.Devices.Remove(bdi);
            //Set the NoRecovery property to False.
            rs.NoRecovery = false;
            //Add the device that contains the differential backup to the Restore object.
            rs.Devices.Add(bdid);
            //Restore the differential database backup with recovery.
            rs.SqlRestore(srv);
            //Inform the user that the differential database restore is complete.
            Console.WriteLine("Differential Database Restore complete.");
            //Remove the device.
            rs.Devices.Remove(bdid);
            //Set the database recovery mode back to its original value.
            db.RecoveryModel = (RecoveryModel)recoverymod;
            //Drop the table that was added.
            db.Tables["test_table"].Drop();
            db.Alter();
            //Remove the backup files from the hard disk.
            //This location is dependent on the installation of SQL Server
            File.Delete("C:\\Program Files\\Microsoft SQL Server\\MSSQL10.MSSQLSERVER\\MSSQL\\Backup\\Test_Full_Backup1");
            File.Delete("C:\\Program Files\\Microsoft SQL Server\\MSSQL10.MSSQLSERVER\\MSSQL\\Backup\\Test_Differential_Backup1");
        }</PRE>
                                </div>
                            </FIGURE>
                        </div>
                        <div class="example-item" id="0x8879b40057eb3a132bdcf152706ae60fe4ababe4234eab1e71db6a0d6f01dd86-119,,156,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #24</div>
                                    <div id="rating_24" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="119,,156," data-hash="0x8879b40057eb3a132bdcf152706ae60fe4ababe4234eab1e71db6a0d6f01dd86">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '24')" data-id="rating_24"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'24')" data-id="rating_24"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0x8879b40057eb3a132bdcf152706ae60fe4ababe4234eab1e71db6a0d6f01dd86-119,,156,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0x8879b40057eb3a132bdcf152706ae60fe4ababe4234eab1e71db6a0d6f01dd86&amp;fullName=FrmSoftEmpenios.cs&amp;project=JC-Developers%2FSoftEmpeniosCergo')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2FJC-Developers%2FSoftEmpeniosCergo%2Fblob%2Fmaster%2FFrmSoftEmpenios.cs"
                                               target="_blank" rel="nofollow">FrmSoftEmpenios.cs</A>
                                        </NOBR>                                 <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2FJC-Developers%2FSoftEmpeniosCergo"
                                               target="_blank" rel="nofollow">JC-Developers/SoftEmpeniosCergo</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="24">
<PRE class="line-numbers language-csharp" data-end="156" data-highlight="148" data-start="120">        public void RestoreDataBase(string backupFilePath, string destinationDatabaseName, string databaseFolder, string databaseFileName, string databaseLogFileName)
        {
            try
            {
                Server srv = GetServer();
                Restore restore = new Restore { Database = destinationDatabaseName, Action = RestoreActionType.Database };
                Database database = srv.Databases[destinationDatabaseName];
                if (database != null)
                {
                    srv.KillAllProcesses(destinationDatabaseName);
                    string primaryFilePath = database.PrimaryFilePath;
                    if (backupFilePath != null) restore.Devices.AddDevice(backupFilePath, DeviceType.File);
                    DataTable datosbackup = restore.ReadFileList(srv);
                    restore.ReplaceDatabase = true;
                    //restore.NoRecovery = true;
                    string physicalFileName = String.Format(@"{0}\{1}.mdf", primaryFilePath, destinationDatabaseName);
                    string str3 = String.Format(@"{0}\{1}_log.ldf", primaryFilePath, destinationDatabaseName);
                    restore.RelocateFiles.Add(new RelocateFile(datosbackup.Rows[0][0].ToString(), physicalFileName));
                    restore.RelocateFiles.Add(new RelocateFile(datosbackup.Rows[1][0].ToString(), str3));
                }
                //restore.ReplaceDatabase = true;
                restore.PercentCompleteNotification = 5;
                restore.PercentComplete += Progreso_PercentComplete;
                restore.Complete += Progreso_Complete;
                restore.SqlRestore(srv);
                srv.Databases[destinationDatabaseName].SetOnline();
                srv.Databases[destinationDatabaseName].Refresh();
            }
            catch (SqlException ex)
            {
                MessageBox.Show(ex.Message);
            }
        }</PRE>
                                </div>
                            </FIGURE>
                        </div><SPAN class="ezoic-adpicker-ad"
                                    id="ezoic-pub-ad-placeholder-150"></SPAN><SPAN class="ezoic-ad portrait-1 adtester-container adtester-container-150"
                                                                                   style="margin: 15px 0px !important; text-align: center !important; float: none; display: block !important; min-height: 250px; min-width: 300px;"
                                                                                   data-ez-name="hotexamples_com-portrait-1">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-portrait-1-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 250px; min-width: 300px;"
                                  ezah="250" ezaw="300">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0xd4b381d4bf0fb6a89311572470432f4a6456e2ccf5c9c8d0e099a86267a17868-53,,117,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #25</div>
                                    <div id="rating_25" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="53,,117," data-hash="0xd4b381d4bf0fb6a89311572470432f4a6456e2ccf5c9c8d0e099a86267a17868">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '25')" data-id="rating_25"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'25')" data-id="rating_25"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0xd4b381d4bf0fb6a89311572470432f4a6456e2ccf5c9c8d0e099a86267a17868-53,,117,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0xd4b381d4bf0fb6a89311572470432f4a6456e2ccf5c9c8d0e099a86267a17868&amp;fullName=Equisoft.SimpleDatabaseRestore%2FRestoreDatabaseService.cs&amp;project=EquisoftDev%2FEquisoft.SimpleDatabaseRestore')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2FEquisoftDev%2FEquisoft.SimpleDatabaseRestore%2Fblob%2Fmaster%2FEquisoft.SimpleDatabaseRestore%2FRestoreDatabaseService.cs"
                                               target="_blank" rel="nofollow">RestoreDatabaseService.cs</A>
                                        </NOBR>                                 <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2FEquisoftDev%2FEquisoft.SimpleDatabaseRestore"
                                               target="_blank" rel="nofollow">EquisoftDev/Equisoft.SimpleDatabaseRestore</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="25">
<PRE class="line-numbers language-csharp" data-end="117" data-highlight="87" data-start="54">        public void Restore(DatabaseRestoreRequest request, PercentCompleteEventHandler percentCompleteDelegate)
        {
            var server = new Server(request.TargetInstance);
            Database database = server.Databases[request.TargetDatabase];
            // Start by locking down the database
            database.DatabaseOptions.UserAccess = DatabaseUserAccess.Single;
            database.Alter(TerminationClause.RollbackTransactionsImmediately);
            var restoreDb = new Restore { Database = database.Name, Action = RestoreActionType.Database };
            //Specify whether you want to restore database or files or log etc
            restoreDb.Devices.AddDevice(request.FullBackupFile, DeviceType.File);
            // For now we only support database replacement.
            restoreDb.ReplaceDatabase = true;
            // For full backup no recovery is not usefull. Will need to to change this if support for restoring transactional backup file happens.
            restoreDb.NoRecovery = false;
            // Associate the correct physical path for each file to be restored
            foreach (FileToRestore fileToRestore in request.FilesLists)
            {
                restoreDb.RelocateFiles.Add(new RelocateFile(fileToRestore.BackupLogicalName,
                                                             fileToRestore.TargetPhysicalPath));
            }
            if (percentCompleteDelegate != null)
            {
                restoreDb.PercentComplete += percentCompleteDelegate;
            }
            // Magic!
            restoreDb.SqlRestore(server);
            restoreDb.SqlRestoreAsync(server);
            // After the restore, ensure the recovery model is set to simple.
            // Since we only support DEV/TEST/DEMO, we dont want the overhead of the other recovery models.
            database.RecoveryModel = RecoveryModel.Simple;
            database.Alter();
            string sqlConnectionString = string.Format("Integrated Security=SSPI;Persist Security Info=True;Initial Catalog={1};Data Source={0}", server.Name, database.Name);
            foreach (var script in request.ScriptsToExecute)
            {
                var fileInfo = new FileInfo(script);
                string sql;
                using (var text = fileInfo.OpenText())
                {
                    sql = text.ReadToEnd();
                    text.Close();
                }
                SqlConnection connection = new SqlConnection(sqlConnectionString);
                Server srv = new Server(new ServerConnection(connection));
                srv.ConnectionContext.SqlExecutionModes = SqlExecutionModes.ExecuteAndCaptureSql;
                srv.ConnectionContext.ExecuteNonQuery(sql);
            }
        }</PRE>
                                </div>
                            </FIGURE>
                        </div>
                        <div class="example-item" id="0x7c31d7e89a78fc1ebf48ccc749522dafaac8136a4700eef9e73b9801f1381c1d-552,,582,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #26</div>
                                    <div id="rating_26" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="552,,582," data-hash="0x7c31d7e89a78fc1ebf48ccc749522dafaac8136a4700eef9e73b9801f1381c1d">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '26')" data-id="rating_26"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'26')" data-id="rating_26"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0x7c31d7e89a78fc1ebf48ccc749522dafaac8136a4700eef9e73b9801f1381c1d-552,,582,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0x7c31d7e89a78fc1ebf48ccc749522dafaac8136a4700eef9e73b9801f1381c1d&amp;fullName=trunk%2Fwinagent%2F1-winagentd%2Fprimaveraconsole%2FMain.cs&amp;project=ketheriel%2FETVA')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fketheriel%2FETVA%2Fblob%2Fmaster%2Ftrunk%2Fwinagent%2F1-winagentd%2Fprimaveraconsole%2FMain.cs"
                                               target="_blank" rel="nofollow">Main.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fketheriel%2FETVA"
                                               target="_blank" rel="nofollow">ketheriel/ETVA</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="26">
<PRE class="line-numbers language-csharp" data-end="582" data-highlight="579" data-start="553">        private static void restore(Server srv, string d, string f)
        {
            // Backup device
            BackupDeviceItem bdi = default(BackupDeviceItem);
            bdi = new BackupDeviceItem(f, DeviceType.File);
            // Delete database before restoring it
            Database db = default(Database);
            db = srv.Databases[d];
            //Define a Restore object variable.
            Restore rs = new Restore();
            //Set the NoRecovery property to true, so the transactions are not recovered.
            rs.NoRecovery = false;
            // set to replace database
            rs.ReplaceDatabase = true;
            //Add the device that contains the full database backup to the Restore object.
            rs.Devices.Add(bdi);
            //Specify the database name.
            rs.Database = d;
            //Restore the full database backup with no recovery.
            rs.SqlRestore(srv);
            //Inform the user that the Full Database Restore is complete.
            Common.WriteToConsoleOut("Full Database Restore complete.");
        }</PRE>
                                </div>
                            </FIGURE>
                        </div>
                        <div class="example-item" id="0xe34c83a23bc211588d1d1df65018334ef1e752cb0d156902a51caa0a339c17d3-368,,392,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #27</div>
                                    <div id="rating_27" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="368,,392," data-hash="0xe34c83a23bc211588d1d1df65018334ef1e752cb0d156902a51caa0a339c17d3">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '27')" data-id="rating_27"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'27')" data-id="rating_27"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0xe34c83a23bc211588d1d1df65018334ef1e752cb0d156902a51caa0a339c17d3-368,,392,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0xe34c83a23bc211588d1d1df65018334ef1e752cb0d156902a51caa0a339c17d3&amp;fullName=Libraries%2FSqlSchemaUpgradeManager.cs&amp;project=codaxy%2Fcommon')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fcodaxy%2Fcommon%2Fblob%2Fmaster%2FLibraries%2FSqlSchemaUpgradeManager.cs"
                                               target="_blank" rel="nofollow">SqlSchemaUpgradeManager.cs</A>
                                        </NOBR>                                 <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fcodaxy%2Fcommon"
                                               target="_blank" rel="nofollow">codaxy/common</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="27">
<PRE class="line-numbers language-csharp" data-end="392" data-highlight="391" data-start="369">        private void RollbackUpgrade(Server server, String databaseName)
        {
            if (backupFilePath != null)
            {
                Logger.DebugFormat("Restoring database from '{0}'.", backupFilePath);
                var db = server.Databases[databaseName];
                server.KillAllProcesses(databaseName);
                Restore restoreDB = new Restore();
                restoreDB.Database = databaseName;
                /* Specify whether you want to restore database, files or log */
                restoreDB.Action = RestoreActionType.Database;
                restoreDB.Devices.AddDevice(backupFilePath, DeviceType.File);
                restoreDB.ReplaceDatabase = true;
                restoreDB.NoRecovery = false;
                restoreDB.PercentComplete += restoreDB_PercentComplete;
                restoreDB.Complete += restoreDB_Complete;
                restoreDB.SqlRestore(server);
            }
        }</PRE>
                                </div>
                            </FIGURE>
                        </div><SPAN class="ezoic-adpicker-ad"
                                    id="ezoic-pub-ad-placeholder-151"></SPAN><SPAN class="ezoic-ad netboard-2 adtester-container adtester-container-151"
                                                                                   style="margin: 15px 0px !important; text-align: center !important; float: none; display: block !important; min-height: 250px; min-width: 300px;"
                                                                                   data-ez-name="hotexamples_com-netboard-2">
                            <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-netboard-2-0"
                                  style="display: inline-block; position: relative; z-index: 0; min-height: 250px; min-width: 300px;"
                                  ezah="250" ezaw="300">
                            </SPAN>
                        </SPAN>
                        <div class="example-item" id="0x986cf5fddd382f6f59410a166a49fa537b79c220630f1c680ab435348d394757-328,,375,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #28</div>
                                    <div id="rating_28" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="328,,375," data-hash="0x986cf5fddd382f6f59410a166a49fa537b79c220630f1c680ab435348d394757">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '28')" data-id="rating_28"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'28')" data-id="rating_28"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0x986cf5fddd382f6f59410a166a49fa537b79c220630f1c680ab435348d394757-328,,375,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0x986cf5fddd382f6f59410a166a49fa537b79c220630f1c680ab435348d394757&amp;fullName=SQLServer.cs&amp;project=johnbcook%2Fautomation-samples')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fjohnbcook%2Fautomation-samples%2Fblob%2Fmaster%2FSQLServer.cs"
                                               target="_blank" rel="nofollow">SQLServer.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fjohnbcook%2Fautomation-samples"
                                               target="_blank" rel="nofollow">johnbcook/automation-samples</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="28">
<PRE class="line-numbers language-csharp" data-end="375" data-highlight="371" data-start="329">        /// &lt;summary&gt;
        /// Method to Restore a DB from file
        /// &lt;/summary&gt;
        public void RestoreDBFromFile()
        {
            // Call Set Up
            // Not needed if we wrap this in a [Test]
            Server myServer = new Server(CF.Server);
            //Using SQL Server authentication
            myServer.ConnectionContext.LoginSecure = false;
            myServer.ConnectionContext.Login = CF.UserName;
            myServer.ConnectionContext.Password = CF.Password;
            Restore restoreDB = new Restore();
            foreach (Database myDatabase in myServer.Databases)
            {
                Console.WriteLine(myDatabase.Name);
                if (myDatabase.Name.Equals(CF.DBName))
                {
                    restoreDB.Database = myDatabase.Name;
                    // Restore Action = Database
                    restoreDB.Action = RestoreActionType.Database;
                    restoreDB.Devices.AddDevice(CF.RestoreDevicePath, DeviceType.File);
                    // Replace the existing database
                    restoreDB.ReplaceDatabase = true;
                    // Allows for DB recovery after restore
                    restoreDB.NoRecovery = false;
                    /* Wiring up events for progress monitoring */
                    restoreDB.PercentComplete += CompletionStatusInPercent;
                    restoreDB.Complete += Restore_Completed;
                    // Start the restore
                    restoreDB.SqlRestore(myServer);
                }
            }
        }</PRE>
                                </div>
                            </FIGURE>
                        </div>
                        <div class="example-item" id="0xff9c93969a6080ebba8461a9f82383f6f93215dad7a2b191b777cec69db5ac1a-753,,794,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #29</div>
                                    <div id="rating_29" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="753,,794," data-hash="0xff9c93969a6080ebba8461a9f82383f6f93215dad7a2b191b777cec69db5ac1a">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '29')" data-id="rating_29"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'29')" data-id="rating_29"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0xff9c93969a6080ebba8461a9f82383f6f93215dad7a2b191b777cec69db5ac1a-753,,794,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0xff9c93969a6080ebba8461a9f82383f6f93215dad7a2b191b777cec69db5ac1a&amp;fullName=Solutions%2FMain%2FDatabase.cs&amp;project=simondmorias%2FMSBuildExtensionPack')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fsimondmorias%2FMSBuildExtensionPack%2Fblob%2Fmaster%2FSolutions%2FMain%2FDatabase.cs"
                                               target="_blank" rel="nofollow">Database.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fsimondmorias%2FMSBuildExtensionPack"
                                               target="_blank" rel="nofollow">simondmorias/MSBuildExtensionPack</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="29">
<PRE class="line-numbers language-csharp" data-end="794" data-highlight="794" data-start="754">        private void Restore()
        {
            if (this.DatabaseItem == null)
            {
                this.Log.LogError("DatabaseItem is required");
                return;
            }
            if (this.ReplaceDatabase &amp;&amp; this.LogFilePath == null)
            {
                this.Log.LogError("LogFilePath must be specified if ReplaceDatabase is true.");
                return;
            }
            string primaryDataFileName = (!string.IsNullOrEmpty(this.PrimaryDataFileName)) ? this.PrimaryDataFileName : this.DatabaseItem.ItemSpec;
            this.LogTaskMessage(string.Format(CultureInfo.CurrentCulture, "Restoring SQL {2}: {0} from {1}", this.DatabaseItem.ItemSpec, this.DataFilePath.GetMetadata("FullPath"), this.RestoreAction));
            Restore sqlRestore = new Restore { Database = this.DatabaseItem.ItemSpec, Action = this.restoreAction, PercentCompleteNotification = this.NotificationInterval, ReplaceDatabase = this.ReplaceDatabase };
            sqlRestore.Devices.AddDevice(this.DataFilePath.GetMetadata("FullPath"), DeviceType.File);
            sqlRestore.PercentComplete += this.ProgressEventHandler;
            if (string.IsNullOrEmpty(this.LogName))
            {
                this.LogName = primaryDataFileName + "_log";
            }
            // add primary data file
            sqlRestore.RelocateFiles.Add(new RelocateFile(primaryDataFileName, (this.NewDataFilePath != null) ? this.NewDataFilePath.GetMetadata("FullPath") : this.DataFilePath.GetMetadata("FullPath")));
            // add log file, if path provided
            if (this.LogFilePath != null)
            {
                sqlRestore.RelocateFiles.Add(new RelocateFile(this.LogName, this.LogFilePath.GetMetadata("FullPath")));
            }
            // add secondary data file, if name and path provided
            if (!string.IsNullOrEmpty(this.SecondaryDataFileName) &amp;&amp; this.SecondaryDataFilePath != null)
            {
                sqlRestore.RelocateFiles.Add(new RelocateFile(this.SecondaryDataFileName, this.SecondaryDataFilePath.GetMetadata("FullPath")));
            }
            sqlRestore.SqlRestore(this.sqlServer);
        }</PRE>
                                </div>
                            </FIGURE>
                        </div>
                        <div class="example-item" id="0x9b97e443996bd3a184e7c530f9fc01ae8854d48ae1a4d43775aa8b95e8824594-107,,141,">
                            <div class="bs-example">
                                <div>
                                    <div class="bs-example-title">Example #30</div>
                                    <div id="rating_30" style="top: 10px; right: 15px; position: absolute;"
                                         data-area="107,,141," data-hash="0x9b97e443996bd3a184e7c530f9fc01ae8854d48ae1a4d43775aa8b95e8824594">
                                        <div class="rating-amount">0</div><A title="Mark this example as good" class="rating-up btn btn-success"
                                                                             href="javascript:app.addRating(1, '30')" data-id="rating_30"><I class="icon-button icon-thumbs-up"></I></A>
                                        <A title="Mark this example as bad" class="rating-down btn btn-danger"
                                           href="javascript:app.addRating(-1,'30')" data-id="rating_30"><I class="icon-button icon-thumbs-down"></I></A>
                                    </div>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; align-items: center;">
                                    <div style="margin-right: 10px; display: inline-block;">
                                        <A title="Direct link to this example"
                                           class="btn btn-default" href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html#0x9b97e443996bd3a184e7c530f9fc01ae8854d48ae1a4d43775aa8b95e8824594-107,,141,">
                                            <I class="icon-button icon-link"></I>
                                        </A>                 <A class="btn btn-default"
                                                                href="javascript:app.open('https://csharp.hotexamples.com/site/file?hash=0x9b97e443996bd3a184e7c530f9fc01ae8854d48ae1a4d43775aa8b95e8824594&amp;fullName=Pharmacy%2FPharmacy%2FHeThong%2FTBackupRestore.cs&amp;project=dexonhud%2Fpharmacykimhoang')"
                                                                rel="nofollow">Show file</A>
                                    </div>
                                    <div class="example-project-info">
                                        <NOBR>
                                            <SPAN>File:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fdexonhud%2Fpharmacykimhoang%2Fblob%2Fmaster%2FPharmacy%2FPharmacy%2FHeThong%2FTBackupRestore.cs"
                                               target="_blank" rel="nofollow">TBackupRestore.cs</A>
                                        </NOBR>
                                        <NOBR>
                                            <SPAN>Project:</SPAN>
                                            <A href="https://csharp.hotexamples.com/site/redirect?url=https%3A%2F%2Fgithub.com%2Fdexonhud%2Fpharmacykimhoang"
                                               target="_blank" rel="nofollow">dexonhud/pharmacykimhoang</A>
                                        </NOBR>
                                    </div>
                                </div>
                            </div><FIGURE class="highlight">
                                <div class="example" data-id="30">
<PRE class="line-numbers language-csharp" data-end="141" data-highlight="128" data-start="108">        public bool Restore(string path)
        {
            Connect();
            if (srvSql != null)
            {
                try
                // If the user has chosen the file from which he wants the database to be restored
                {
                    // Create a new database restore operation
                    Restore rstDatabase = new Restore();
                    // Set the restore type to a database restore
                    rstDatabase.Action = RestoreActionType.Database;
                    // Set the database that we want to perform the restore on
                    rstDatabase.Database = DBName;
                    BackupDeviceItem bkpDevice = new BackupDeviceItem(path, DeviceType.File);
                    // Add the backup device to the restore type
                    rstDatabase.Devices.Add(bkpDevice);
                    // If the database already exists, replace it
                    rstDatabase.ReplaceDatabase = true;
                    // Perform the restore
                    rstDatabase.SqlRestore(srvSql);
                }
                catch(Exception ex) {
                    TLog.WriteErr("TBackup.cs_retore ",ex.Message);
                    return false;
                }
            }
            else
            {
                TLog.WriteErr("TBackup.cs_retore ", "Not Connected to Server");
                return false;
            }
            return true;
        }</PRE>
                                </div>
                            </FIGURE>
                        </div>
                        <div id="all-examples"></div>
                    </div>
                </div>
            </div>
            <div class="page-side-banner hidden-xs hidden-sm hidden-md" style="width: 300px;">
                <SPAN id="ezoic-pub-ad-placeholder-131"></SPAN><SPAN class="ezoic-ad banner-2 adtester-container adtester-container-131"
                                                                     style="margin: 2px 0px !important; float: none; display: inline-block; min-height: 300px; min-width: 336px;"
                                                                     data-ez-name="hotexamples_com-banner-2">
                    <SPAN class="ezoic-ad" id="div-gpt-ad-hotexamples_com-banner-2-0"
                          style="display: inline-block; position: relative; z-index: 0; min-height: 280px; min-width: 336px;"
                          ezah="280" ezaw="336">
                    </SPAN><SPAN class="reportline" style="margin: auto; width: 336px; height: 14px; display: block;">
                        <SPAN style="text-align: center; line-height: normal; font-size: smaller; float: left;">
                            <A style="cursor: pointer;" href="https://www.ezoic.com/what-is-ezoic/" target="_blank"
                               rel="noopener noreferrer nofollow">
                                <IMG style="margin: 0px !important; padding: 2px !important; border: 0px currentColor !important; border-image: none !important; width: 58px !important; height: 12px !important; cursor: pointer !important; box-sizing: content-box !important;"
                                     src="hellohelp_files/ezoic.png">
                            </A>
                        </SPAN><SPAN class="ez-report-ad-button"
                                     style="color: rgb(165, 165, 165); line-height: normal; font-family: arial !important; font-size: 12px !important; text-decoration: none !important; float: right; cursor: pointer !important;"
                                     name="?pageview_id=816fd9be-c166-410f-6387-0a87f40e75ec&amp;ad_position_id=131&amp;impression_group_id=hotexamples_com-banner-2/2019-10-25/122695&amp;ad_size=336x280&amp;domain_id=110793&amp;url=https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html">
                            report
                            this ad
                        </SPAN>
                    </SPAN>
                </SPAN>
            </div>
        </div>
    </div><FOOTER class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-12" style="text-align: center;">
                    <A href="https://csharp.hotexamples.com/site/trends?type=csharp%7Cc">
                        Top Classes
                    </A>                                    |                     <A href="https://csharpdoc.hotexamples.com/doc/map">Documentation</A>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12" style="text-align: center;">
                    <A href="https://hotexamples.com/">PHP</A>
                    | <A href="https://csharp.hotexamples.com/">C# (CSharp)</A>
                    | <A href="https://java.hotexamples.com/">Java</A>
                    | <A href="https://golang.hotexamples.com/">Golang</A>
                    | <A href="https://cpp.hotexamples.com/">C++ (Cpp)</A>
                    | <A href="https://python.hotexamples.com/">Python</A>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12" style="text-align: center;">
                    <A href="https://csharp.hotexamples.com/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html">EN</A>
                    |
                    <A href="https://csharp.hotexamples.com/ru/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html">RU</A>
                    |
                    <A href="https://csharp.hotexamples.com/de/examples/-/Restore/SqlRestore/php-restore-sqlrestore-method-examples.html">DE</A>

                </div>
            </div>
            <div class="row">
                <div class="col-md-10 col-md-offset-1"></div>
                <div class="col-md-1">

                </div>
            </div>
        </div>
    </FOOTER>
    <script src="hellohelp_files/addthis_widget.js" async="async"></script>

    <script src="hellohelp_files/cff1b7dd28fe0d2d063448afcb04c358e4f451ea.js"></script>



    <div id="dmo1" style="display: none;">

    </div>



    <script type="text/javascript">
  		$(document).ready(function () {
		    $(".arrow-right").bind("click", function (event) {
		        event.preventDefault();
		        $(".vid-list-container").stop().animate({
		            scrollLeft: "+=336"
		        }, 750);
		    });
		    $(".arrow-left").bind("click", function (event) {
		        event.preventDefault();
		        $(".vid-list-container").stop().animate({
		            scrollLeft: "-=336"
		        }, 750);
		    });
  		});

  		var resizeTimeout;
  		function doResize() {
  		    var thumbs = $('.thumb'),list=$('.vid-list');
  		    var wid = $('.vid-item').length * 168;
  		    if (wid > $(window).width() * 1.5) {
  		        var newW=Math.floor(($(window).width() * 1.5) / 168) * 168;
  		        list.css('width',(newW<1680?1680:newW) );
  		    } else {
  		        list.css('width', wid);
  		    };
  		    $(".arrow-left,.arrow-right").css('top', '-' + ($('.vid-list-container').outerHeight() / 2 + 30) + 'px');

  		}
  		$(window).resize(function () {
  		    clearTimeout(resizeTimeout);
  		    resizeTimeout = setTimeout(function () {
  		        doResize();
  		    }, 500);
  		});
  		doResize();


    </script>


</body>


</html><!--[selectron:done]-->
